Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Contact Information
Blue Coat Systems Inc.
420 North Mary Ave
Sunnyvale, CA 94085-4121
http://www.bluecoat.com/support/contact.html
bcs.info@bluecoat.com
http://www.bluecoat.com
For concerns or feedback about the documentation: documentation@bluecoat.com

Copyright© 1999-2007 Blue Coat Systems, Inc. All rights reserved worldwide. No part of this document may be reproduced by any means
nor modified, decompiled, disassembled, published or distributed, in whole or in part, or translated to any electronic medium or other
means without the written consent of Blue Coat Systems, Inc. All right, title and interest in and to the Software and documentation are
and shall remain the exclusive property of Blue Coat Systems, Inc. and its licensors. ProxyAV™, CacheOS™, SGOS™, SG™, Spyware
Interceptor™, Scope™, RA Connector™, RA Manager™, Remote Access™ and MACH5™ are trademarks of Blue Coat Systems, Inc. and
CacheFlow®, Blue Coat®, Accelerating The Internet®, ProxySG®, WinProxy®, AccessNow®, Ositis®, Powering Internet Management®,
The Ultimate Internet Sharing Solution®, Cerberian®, Permeo®, Permeo Technologies, Inc.®, and the Cerberian and Permeo logos are
registered trademarks of Blue Coat Systems, Inc. All other trademarks contained in this document and in the Software are the property of
their respective owners.
BLUE COAT SYSTEMS, INC. DISCLAIMS ALL WARRANTIES, CONDITIONS OR OTHER TERMS, EXPRESS OR IMPLIED,
STATUTORY OR OTHERWISE, ON SOFTWARE AND DOCUMENTATION FURNISHED HEREUNDER INCLUDING WITHOUT
LIMITATION THE WARRANTIES OF DESIGN, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL BLUE COAT SYSTEMS, INC., ITS SUPPLIERS OR ITS LICENSORS BE LIABLE FOR
ANY DAMAGES, WHETHER ARISING IN TORT, CONTRACT OR ANY OTHER LEGAL THEORY EVEN IF BLUE COAT SYSTEMS,
INC. HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

Document Number: 231-02843
Document Revision: SGOS 5.2.2—09/2007

ii

Contents
Contact Information

Chapter 1: Introduction
Document Conventions....................................................................................................................................13
Chapter 2: Managing Policy Files
Creating and Editing Policy Files....................................................................................................................15
Using the Management Console ..............................................................................................................16
Using the CLI Inline Command ..............................................................................................................18
Unloading Policy Files......................................................................................................................................19
Configuring Policy Options .............................................................................................................................20
Policy File Evaluation ................................................................................................................................20
Transaction Settings: Deny and Allow....................................................................................................20
Policy Tracing .............................................................................................................................................21
Managing the Central Policy File....................................................................................................................22
Configuring Automatic Installation ........................................................................................................22
Configuring a Custom Central Policy File for Automatic Installation...............................................22
Configuring E-mail Notification ..............................................................................................................22
Configuring the Update Interval .............................................................................................................23
Checking for an Updated Central Policy File ........................................................................................23
Resetting the Policy Files...........................................................................................................................23
Moving VPM Policy Files from One SG Appliance to Another..........................................................23
Viewing Policy Files..........................................................................................................................................23
Viewing the Installed Policy.....................................................................................................................24
Viewing Policy Source Files......................................................................................................................24
Viewing Policy Statistics ...........................................................................................................................24
Chapter 3: The Visual Policy Manager
Section A: About the Visual Policy Manager
Launching the Visual Policy Manager ...........................................................................................................28
About the Visual Policy Manager User Interface .........................................................................................28
Menu Bar .....................................................................................................................................................29
Tool Bar........................................................................................................................................................30
Policy Layer Tabs .......................................................................................................................................30
Rules and Objects .......................................................................................................................................31
About Code Sharing With the Management Console ..........................................................................31
About VPM Components.................................................................................................................................32

iii

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Policy Layers............................................................................................................................................... 32
Rule Objects ................................................................................................................................................ 33
Policy Layer/Object Matrix...................................................................................................................... 35
The Set Object Dialog ....................................................................................................................................... 35
The Add/Edit Object Dialog ........................................................................................................................... 37
Online Help........................................................................................................................................................ 37
Section B: Policy Layer and Rule Object Reference
About the Reference Tables ............................................................................................................................. 38
Administration Authentication Policy Layer Reference ............................................................................. 38
Administration Access Policy Layer Reference............................................................................................ 39
DNS Access Policy Layer Reference............................................................................................................... 39
SOCKS Authentication Policy Layer Reference ........................................................................................... 40
SSL Intercept Layer Reference......................................................................................................................... 40
SSL Access Layer Reference ............................................................................................................................ 41
Web Authentication Policy Layer Reference ................................................................................................ 42
Web Access Policy Layer Reference ............................................................................................................... 43
Web Content Policy Layer Reference............................................................................................................. 46
Forwarding Policy Layer Reference ............................................................................................................... 47
Section C: Detailed Object Column Reference
Source Column Object Reference.................................................................................................................... 49
Any............................................................................................................................................................... 49
Streaming Client......................................................................................................................................... 49
Client Hostname Unavailable .................................................................................................................. 49
Authenticated User.................................................................................................................................... 49
Guest User................................................................................................................................................... 49
Client IP Address/Subnet ........................................................................................................................ 50
Client Hostname ........................................................................................................................................ 50
Proxy IP Address/Port ............................................................................................................................. 50
User .............................................................................................................................................................. 50
Group........................................................................................................................................................... 53
Attribute ...................................................................................................................................................... 56
User Login Address................................................................................................................................... 57
User Login Time......................................................................................................................................... 57
User Login Count....................................................................................................................................... 57
Client Address Login Count .................................................................................................................... 57
User Authentication Error ........................................................................................................................ 57
User Authorization Error.......................................................................................................................... 58
DNS Request Name ................................................................................................................................... 59
RDNS Request IP Address/Subnet......................................................................................................... 59
DNS Request Opcode................................................................................................................................ 59
DNS Request Class .................................................................................................................................... 59
DNS Request Type..................................................................................................................................... 60
DNS Client Transport................................................................................................................................ 60

iv

Contents

SOCKS Version........................................................................................................................................... 60
User Agent .................................................................................................................................................. 60
IM User Agent ............................................................................................................................................ 61
Request Header .......................................................................................................................................... 61
Client Certificate ........................................................................................................................................ 62
IM User ........................................................................................................................................................ 62
P2P Client.................................................................................................................................................... 62
Client Negotiated Cipher.......................................................................................................................... 63
Client Negotiated Cipher Strength.......................................................................................................... 63
Client Negotiated SSL Version ................................................................................................................ 63
Client Connection DSCP Trigger............................................................................................................. 63
Combined Source Object........................................................................................................................... 64
Source Column/Policy Layer Matrix...................................................................................................... 65
Destination Column Object Reference ........................................................................................................... 66
Any............................................................................................................................................................... 66
DNS Response Contains No Data ........................................................................................................... 66
Destination IP Address/Subnet............................................................................................................... 66
Destination Host/Port .............................................................................................................................. 66
Request URL ............................................................................................................................................... 66
Request URL Category.............................................................................................................................. 68
Category ...................................................................................................................................................... 69
Server URL.................................................................................................................................................. 70
Server Certificate........................................................................................................................................ 70
Server Certificate Category ...................................................................................................................... 70
Server Negotiated Cipher ......................................................................................................................... 70
Server Negotiated Cipher Strength ......................................................................................................... 70
Server Negotiated SSL Version................................................................................................................ 70
File Extensions............................................................................................................................................ 71
HTTP MIME Types.................................................................................................................................... 71
Apparent Data Type .................................................................................................................................. 71
Response Code ........................................................................................................................................... 71
Response Header ....................................................................................................................................... 72
Response Data ............................................................................................................................................ 72
IM Buddy .................................................................................................................................................... 73
IM Chat Room ............................................................................................................................................ 73
DNS Response IP Address/Subnet......................................................................................................... 73
RDNS Response Host................................................................................................................................ 74
DNS Response CNAME............................................................................................................................ 74
DNS Response Code.................................................................................................................................. 74
Server Connection DSCP Trigger ............................................................................................................ 74
Combined Destination Objects ................................................................................................................ 75
Destination Column/Policy Layer Matrix ............................................................................................. 75

v

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Service Column Object Reference................................................................................................................... 76
Any............................................................................................................................................................... 76
Using HTTP Transparent Authentication .............................................................................................. 76
Virus Detected ............................................................................................................................................ 76
Request Forwarded.................................................................................................................................... 76
Client Protocol............................................................................................................................................ 76
Service Name.............................................................................................................................................. 77
Protocol Methods ....................................................................................................................................... 77
SSL Proxy Mode ......................................................................................................................................... 78
IM File Transfer.......................................................................................................................................... 78
IM Message Text ........................................................................................................................................ 78
IM Message Reflection .............................................................................................................................. 79
Streaming Content Type ........................................................................................................................... 79
ICAP Error Code ........................................................................................................................................ 80
Health Check .............................................................................................................................................. 81
Health Status............................................................................................................................................... 81
Combined Service Objects ........................................................................................................................ 81
Service Column/Policy Layer Matrix..................................................................................................... 82
Time Column Object Reference ...................................................................................................................... 82
Any............................................................................................................................................................... 82
Time ............................................................................................................................................................. 82
Combined Time Object ............................................................................................................................. 84
Time Column/Policy Layer Matrix ........................................................................................................ 84
Action Column Object Reference.................................................................................................................... 84
Allow ........................................................................................................................................................... 84
Deny............................................................................................................................................................. 84
Force Deny .................................................................................................................................................. 84
Force Deny (Content Filter) ...................................................................................................................... 85
Allow Content From Origin Server......................................................................................................... 85
Connect Using ADN When Possible/Do Not Connect Using ADN ................................................. 85
Allow Read-Only Access .......................................................................................................................... 85
Allow Read-Write Access ......................................................................................................................... 85
Do Not Authenticate ................................................................................................................................. 85
Authenticate................................................................................................................................................ 85
Authenticate Guest .................................................................................................................................... 87
Add Default Group.................................................................................................................................... 88
Force Authenticate..................................................................................................................................... 88
Bypass Cache .............................................................................................................................................. 89
Do Not Bypass Cache ................................................................................................................................ 89
Bypass DNS Cache..................................................................................................................................... 89
Do Not Bypass DNS Cache ...................................................................................................................... 89
Allow DNS From Upstream Server ........................................................................................................ 89
Serve DNS Only From Cache................................................................................................................... 89

vi

Contents

Enable/Disable DNS Imputing ............................................................................................................... 89
Check/Do Not Check Authorization...................................................................................................... 89
Always Verify............................................................................................................................................. 90
Use Default Verification............................................................................................................................ 90
Block/Do Not Block PopUp Ads............................................................................................................. 90
Force/Do Not Force IWA for Server Auth ............................................................................................ 90
Log Out/Do Not Log Out Other Users With Same IP ......................................................................... 90
Log Out/Do Not Log Out User ............................................................................................................... 90
Log Out/Do Not Log Out User’s Other Sessions ................................................................................. 91
Reflect/Do Not Reflect IM Messages...................................................................................................... 91
Support/Do Not Support Persistent Client Requests .......................................................................... 91
Support/Do Not Support Persistent Server Requests.......................................................................... 91
Block/Do Not Block IM Encryption ....................................................................................................... 91
Require/Do Not Require Client Certificate ........................................................................................... 91
Trust/Do Not Trust Destination IP......................................................................................................... 91
Deny............................................................................................................................................................. 92
Return Exception........................................................................................................................................ 92
Return Redirect .......................................................................................................................................... 93
Set Client Certificate Validation .............................................................................................................. 93
Set Server Certificate Validation.............................................................................................................. 93
Enable HTTPS Intercept............................................................................................................................ 94
Enable HTTPS Intercept on Exception.................................................................................................... 95
Disable SSL Intercept................................................................................................................................. 96
Send IM Alert ............................................................................................................................................. 96
Modify Access Logging ............................................................................................................................ 96
Override Access Log Field........................................................................................................................ 97
Rewrite Host ............................................................................................................................................... 98
Reflect IP...................................................................................................................................................... 98
Suppress Header ........................................................................................................................................ 99
Control Request Header/Control Response Header ......................................................................... 100
Notify User................................................................................................................................................ 101
Strip Active Content ................................................................................................................................ 104
HTTP Compression Level....................................................................................................................... 106
Set Client HTTP Compression ............................................................................................................... 106
Set Server HTTP Compression............................................................................................................... 107
Manage Bandwidth ................................................................................................................................. 107
ADN Server Optimization...................................................................................................................... 107
Modify IM Message................................................................................................................................. 108
Return ICAP Feedback............................................................................................................................ 108
Set Dynamic Categorization................................................................................................................... 110
Set External Filter Service ....................................................................................................................... 110
Set ICAP Request Service ....................................................................................................................... 111

vii

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Set ICAP Response Service..................................................................................................................... 112
Set FTP Connection.................................................................................................................................. 112
Set SOCKS Acceleration.......................................................................................................................... 113
Disable SSL Detection ............................................................................................................................. 113
Set Streaming Max Bitrate ...................................................................................................................... 114
Set Client Connection DSCP Value ....................................................................................................... 114
Set Server Connection DSCP Value....................................................................................................... 115
Set ADN Connection DSCP.................................................................................................................... 115
Set Authorization Refresh Time ............................................................................................................ 116
Set Credential Refresh Time................................................................................................................... 116
Set Surrogate Refresh Time .................................................................................................................... 116
Send DNS/RDNS Response Code ........................................................................................................ 116
Send DNS Response ................................................................................................................................ 116
Send Reverse DNS Response ................................................................................................................. 117
Do Not Cache ........................................................................................................................................... 117
Force Cache............................................................................................................................................... 118
Use Default Caching................................................................................................................................ 118
Mark/Do Not Mark As Advertisement ............................................................................................... 118
Enable/Disable Pipelining ..................................................................................................................... 118
Set TTL....................................................................................................................................................... 118
Send Direct................................................................................................................................................ 118
Integrate/Do Not Integrate New Hosts ............................................................................................... 118
Allow Content From Origin Server....................................................................................................... 118
Serve Content Only From Cache ........................................................................................................... 118
Select SOCKS Gateway ........................................................................................................................... 119
Select Forwarding .................................................................................................................................... 119
Server Byte Caching ................................................................................................................................ 119
Set IM Transport ...................................................................................................................................... 119
Set Streaming Transport ......................................................................................................................... 119
Authentication Charset ........................................................................................................................... 120
Set IP Address For Authentication........................................................................................................ 120
Permit Authentication Error .................................................................................................................. 121
Permit Authorization Error .................................................................................................................... 122
Combined Action Objects ....................................................................................................................... 123
Action Column/Policy Layer Matrix.................................................................................................... 123
Track Object Column Reference ................................................................................................................... 125
Event Log, E-mail, and SNMP ............................................................................................................... 126
Tracing Objects......................................................................................................................................... 127
Combined Track Object .......................................................................................................................... 128
Track Objects/Policy Layer Matrix ....................................................................................................... 128
Comment Object Reference ........................................................................................................................... 128
Using Combined Objects ............................................................................................................................... 128
Centralized Object Viewing and Managing................................................................................................ 131

viii

Contents

Viewing Objects ....................................................................................................................................... 131
Managing Objects .................................................................................................................................... 133
Creating Categories ........................................................................................................................................ 134
Refreshing Policy ..................................................................................................................................... 136
Restricting DNS Lookups .............................................................................................................................. 136
About DNS Lookup Restriction............................................................................................................. 136
Creating the DNS Lookup Restriction List .......................................................................................... 136
Restricting Reverse DNS Lookups ............................................................................................................... 137
About Reverse DNS Lookup Restriction.............................................................................................. 137
Creating the Reverse DNS Lookup Restriction List ........................................................................... 137
Setting the Group Log Order......................................................................................................................... 137
About the Group Log Order .................................................................................................................. 137
Creating the Group Log Order List....................................................................................................... 138
Section D: Managing Policy Layers, Rules, and Files
How Policy Layers, Rules, and Files Interact.............................................................................................. 139
How VPM Layers Relate to CPL Layers............................................................................................... 139
Ordering Rules in a Policy Layer........................................................................................................... 140
Using Policy Layers of the Same Type ................................................................................................. 140
Ordering Policy Layers ........................................................................................................................... 141
About the Layer Guard Rule.................................................................................................................. 142
Installing Policies ............................................................................................................................................ 143
Managing Policy.............................................................................................................................................. 144
Refreshing Policy ..................................................................................................................................... 144
Reverting to a Previous Policy ............................................................................................................... 144
Changing Policies .................................................................................................................................... 144
Managing Policy Layers.......................................................................................................................... 144
Managing Policy Rules............................................................................................................................ 145
Installing VPM-Created Policy Files ............................................................................................................ 145
Viewing the Policy/Created CPL ................................................................................................................. 148
Section E: Tutorials
Tutorial—Creating a Web Authentication Policy ...................................................................................... 149
Example 1: Create an Authentication Rule .......................................................................................... 149
Example 2: Exempt Specific Users from Authentication ................................................................... 153
Tutorial—Creating a Web Access Policy ..................................................................................................... 155
Example 1: Restrict Access to Specific Websites ................................................................................. 155
Example 2: Allow Specific Users to Access Specific Websites .......................................................... 159
Chapter 4: Advanced Policy Tasks
Section A: Blocking Pop Up Windows
About Pop Up Blocking ................................................................................................................................. 170
Interactivity Notes .......................................................................................................................................... 170
Recommendations........................................................................................................................................... 170

ix

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Section B: Stripping or Replacing Active Content
About Active Content..................................................................................................................................... 172
About Active Content Types ......................................................................................................................... 172
Script Tags................................................................................................................................................. 172
JavaScript Entities .................................................................................................................................... 173
JavaScript Strings ..................................................................................................................................... 173
JavaScript Events...................................................................................................................................... 173
Embed Tags .............................................................................................................................................. 173
Object Tags................................................................................................................................................ 174
Section C: Modifying Headers
Section D: Defining Exceptions
Built-in Exceptions .......................................................................................................................................... 176
User-Defined Exceptions ............................................................................................................................... 180
About Exception Definitions ......................................................................................................................... 180
About the Exceptions Hierarchy................................................................................................................... 181
About the Exceptions Installable List........................................................................................................... 182
Creating or Editing Exceptions ..................................................................................................................... 183
Creating and Installing an Exceptions List.................................................................................................. 184
Viewing Exceptions ........................................................................................................................................ 186
Section E: Managing Peer-to-Peer Services
About Peer-to-Peer Communications .......................................................................................................... 188
About The Blue Coat Solution....................................................................................................................... 188
Supported Services .................................................................................................................................. 188
Deployment .............................................................................................................................................. 188
Policy Control .................................................................................................................................................. 189
VPM Support ............................................................................................................................................ 189
CPL Support ............................................................................................................................................. 189
Policy Example ......................................................................................................................................... 190
P2P History Statistics...................................................................................................................................... 190
P2P Clients ................................................................................................................................................ 191
P2P Bytes ................................................................................................................................................... 192
Proxy Authentication ..................................................................................................................................... 193
Access Logging................................................................................................................................................ 193
Section F: Managing QoS and Differential Services
About The Blue Coat Solution....................................................................................................................... 194
About DSCP Values........................................................................................................................................ 194
About QoS Policy Tasks ................................................................................................................................. 196
Testing Incoming QoS ............................................................................................................................. 196
Setting the Outgoing QoS ....................................................................................................................... 196
Policy Components ......................................................................................................................................... 199
VPM Objects ............................................................................................................................................. 199
VPM Example........................................................................................................................................... 199
CPL Components ..................................................................................................................................... 200

x

Contents

Access Logging................................................................................................................................................ 201
Appendix A: Glossary

xi

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

xii

Chapter 1: Introduction

Creating policy is the core task of implementing Blue Coat SG appliances into the
enterprise. After the basic SG appliance configurations are complete, defined policy is
what controls user activities and implements company authentication and network
resource allocation goals.
The Visual Policy Manager is a user interface that creates underlying Blue Coat Content
Policy Language (CPL). In the VPM, you create policy layers by selecting and
customizing policy objects. This volume discusses the facets of the VPM, including layer
interactions and summary object descriptions. When approrpriate, cross references are
provided to other Blue Coat volumes that describe the conceptual information of the
feature. This volume also contains a chapter that discusses some common tasks that are
only achieved through policy, not the Management Console.
This document contains the following chapters:
❐

Chapter 2: "Managing Policy Files" on page 15

❐

Chapter 3: "The Visual Policy Manager" on page 27

❐

Chapter 4: "Advanced Policy Tasks" on page 169

Document Conventions
The following section lists the typographical and Command Line Interface (CLI) syntax
conventions used in this manual.
Table 1-1. Document Conventions
Conventions

Definition

Italics

The first use of a new or Blue Coat-proprietary term.

Courier font

Command line text that appears on your administrator workstation.

Courier Italics

A command line variable that is to be substituted with a literal name or
value pertaining to the appropriate facet of your network system.

Courier Boldface

A Blue Coat literal to be entered as shown.

{ }

One of the parameters enclosed within the braces must be supplied

[ ]

An optional parameter or parameters.

|

Either the parameter before or after the pipe character can or must be
selected, but not both.

13

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

14

Chapter 2: Managing Policy Files

Policy files contain the policies (triggers and actions) that manage every aspect of the
SG appliance, from controlling user authentication and privileges to disabling access
logging or determining the version of SOCKS.
The policy for a given system can contain several files with many layers and rules in
each. Policies can be defined through the Visual Policy Manager (VPM) or composed in
Content Policy Language (CPL). (Some advanced policy features are not available in
VPM and can only be configured through CPL.)
Policies are managed through four files:
❐

Central policy file—Contains global settings to improve performance and behavior
and filters for important and emerging viruses (such as Code Red and Nimda).
This file is usually managed by Blue Coat, although you can point the SG appliance
to a custom Central policy file instead.

❐

Forward policy file—Usually used to supplement any policy created in the other
three policy files. The Forward policy file contains Forwarding rules when the
system is upgraded from a previous version of SGOS (2.x) or CacheOS (4.x).

❐

Local policy file—A file you create yourself. When the VPM is not the primary tool
used to define policy, the Local file contains the majority of the policy rules for a
system. If the VPM is the primary tool, this file is either empty or includes rules for
advanced policy features that are not available in VPM.

❐

Visual Policy Manager—The policy created by the VPM can either supplement or
override the policies created in the other policy files.

This chapter contains the following sections:
❐

“Creating and Editing Policy Files” on page 15

❐

“Managing the Central Policy File” on page 22

❐

“Viewing Policy Files” on page 23

To learn about writing policies, refer to Volume 10: Blue Coat SG Appliance Content Policy
Language Guide.

Creating and Editing Policy Files
You can create and edit policy files two ways:
❐

Through the Management console (recommended).

❐

Through the CLI inline policy command (not recommended because the policies
can grow large and using inline policy overwrites any existing policy on the SG
appliance).

15

Chapter 2: Managing Policy Files

Note: Do not use the inline policy command with files created using the
VPM module.
end-of-file-marker—Specifies the string that marks the end of the current
inline command input; eof usually works as a string. The CLI buffers all input

until you enter the marker string.
2.

Define the policy rules using CPL (refer to Volume 10: Blue Coat SG Appliance Content
Policy Language Guide).
Enter each line and press <Enter>. To correct mistakes on the current line, use
<Backspace>. If a mistake has been made in a line that has already been terminated by
<Enter>, exit the inline policy command by typing <Ctrl>c to prevent the file from
being saved.

3.

Enter the eof marker to save the policies and exit the inline mode.

For more information on the inline command, refer to Volume 11: Blue Coat SG Appliance
Command Line Reference.
To load policy files:
At the (config) command prompt, enter the following commands:
SGOS#(config) policy {forward-path | local-path | central-path} url
SGOS#(config) load policy {forward | local | central}

The SG appliance compiles and installs the new policy. The SG appliance might display a
warning if the new policy causes conflicts. If a syntax error is found, the appliance
displays an error message. For information about these messages, refer to Volume 10: Blue
Coat SG Appliance Content Policy Language Guide. Correct the error, then reload the file.

Unloading Policy Files
To disable policies, perform the following procedure to unload the compiled policy file
from the SG appliance memory. These steps describe how to replace a current policy file
with an empty policy file.
To keep a current policy file, either make a backup copy or rename the file before
unloading it. By renaming the file, you can later reload the original policy file. If you use
multiple policy files, back up or rename files as necessary. Alternatively, rather than use
an empty policy file, you can delete the entire contents of the file, then reload it.
To unload policies:
1.

Select Configuration > Policy > Policy Files > Policy Files.

2.

Select Text Editor in the Install Local/Forward/Central File from drop-down list and click
the appropriate Install button. The Edit and Install the Local/Forward/Central Policy
File appears.

3.

Delete the text and click Install.

4.

View the results in the results page that opens; close the page.

5.

Click Close.

19

Chapter 2: Managing Policy Files

A default proxy transaction policy of Allow permits most proxy transactions however, if
protocol detection is enabled (the default), HTTP CONNECT transactions are only
allowed if they are tunneling SSL. If protocol detection is disabled, HTTP CONNECT is
only allowed on port 443. If your policy is set to Allow, you must create policies to
explicitly deny access on a case-by-case basis.
Note: The default proxy policy does not apply to admin transactions. By default, admin

transactions are denied unless you log in using console account credentials or if explicit
policy is written to grant read-only or read-write privileges.
Defaults:
❐

❐

Proxy Edition: The default depends on how you installed SGOS and if it was a new
installation or an upgrade:
•

If you installed the SGOS through a browser using the Initial Configuration Web
site, you chose whether to allow or deny proxied transactions during initial
configuration.

•

If you installed the SGOS using the front panel or a serial console port, the default
setting is Deny.

•

If you upgraded the SGOS from a previous version, the default remains whatever
it was for the previous policy.

MACH5 Edition: The default setting is Allow.

You can always change the setting—see the procedures below for instructions.
Also keep in mind that:
❐

Changing the default proxy transaction policy affects the basic environment in which
the overall policy is evaluated. It is likely that you must revise policies to retain
expected behavior after such a change.

❐

Changes to the evaluation order might result in different effective policy, because the
order of policy evaluation defines general rules and exceptions.

❐

Changing the default proxy transaction policy does not affect the evaluation of cache
and admin transactions.

To configure Deny or Allow default proxy policy:
1.

Select Configuration > Policy > Policy Options.

2.

Under Default Proxy Policy, select either Deny or Allow.

3.

Click Apply to commit the changes to the SG appliance.

Policy Tracing
Tracing enabled with the Management Console or CLI is global; that is, it records every
policy-related event in every layer. It should be used only while troubleshooting. For
information on troubleshooting policy, refer to Volume 10: Blue Coat SG Appliance Content
Policy Language Guide. Turning on policy tracing of any kind is expensive in terms of
system resource usage and slows down the SG appliance's ability to handle traffic.
To enable policy tracing:
1.

Select Configuration > Policy > Policy Options.

21

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

2.

Select Trace all policy execution.

3.

Click Apply.

Managing the Central Policy File
The Central policy file is updated when needed by Blue Coat. The file can be updated
automatically or you can request e-mail notification. You can also configure the path to
point to your own custom Central policy file.

Configuring Automatic Installation
You can specify whether the SG appliance checks for a new version of the Central policy
file. If a new version exists, the appliance can install it automatically.
Perform the following procedure to configure the SG appliance to check for and install a
new version of the Central policy file.
To configure automatic installation:
1.

Select Configuration > Policy > Policy Files > Policy Files.

2.

Select Automatically install new Policy when central file changes.

3.

Click Apply.

Configuring a Custom Central Policy File for Automatic Installation
If you define your own Central policy file, you can configure the SG appliance to
automatically install any subsequent updated version of the file. To use this capability,
you must change the Central policy file’s first line with each version update. With
automatic installation, the SG appliance checks for a change to the first line of the file. In
defining a custom Central policy file, add an item, such as a comment, to the first line of
the Central policy file that changes with each update. The following is a sample first line,
containing date information that is routinely updated with each version:
; Central policy file MonthDate, Year version

When you update and save the file in the original location, the SG appliance automatically
loads the updated version.

Configuring E-mail Notification
You can specify whether the SG appliance sends e-mail when the Central policy file
changes. The e-mail address used is the same as that used in diagnostic reporting: the
event recipient for the custom heartbeat e-mail. For information about diagnostic
reporting, see “Diagnostic Reporting (Heartbeats)” on page 424.
To configure e-mail notification:
1.

Select Configuration > Policy > Policy Files > Policy Files.

2.

Select Send me email when central file changes.

3.

Click Apply.

22

Chapter 2: Managing Policy Files

Configuring the Update Interval
You can specify how frequently the SG appliance checks for a new version of the Central
policy file. By default, the appliance checks for an updated Central policy file once every
24 hours (1440 minutes). You must use the CLI to configure the update interval. You
cannot configure the update interval through the Management Console.
To configure the update interval:
At the (config) command prompt, enter the following command:
SGOS#(config) policy poll-interval minutes

Checking for an Updated Central Policy File
You can manually check whether the Central policy file has changed. You must use the
CLI. You cannot check for updates through the Management Console.
To check for an updated central file:
At the (config) command prompt, enter the following command:
SGOS#(config) policy poll-now

The SG appliance displays a message indicating whether the Central file has changed.

Resetting the Policy Files
You can clear all the policy files automatically through the CLI.
To clear all policy files:
1.

At the (config) command prompt, enter the following command:
SGOS#(config) policy reset
WARNING: This will clear local, central, forward and VPM policy. Are
you sure you want to reset ALL policy files? (y or n)

The SG appliance displays a warning that you are resetting all of your policy files.
2.

Enter y to continue or n to cancel.
Note: This command does not change the default proxy policy settings.

Moving VPM Policy Files from One SG Appliance to Another
VPM policy files are specific to the SG appliance where they were created. But just as you
can use the same Central, Local, and Forward policy files on multiple SG appliance, you
can use VPM policies created on one appliance on other appliances.
For detailed information on moving VPM policy files, see “Installing Policies” on page
143.

Viewing Policy Files
You can view either the compiled policy or the source policy files. Use these procedures to
view policies defined in a single policy file (for example, using VPM) or in multiple policy
files (for example, using the Blue Coat Central policy file and VPM).

23

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Viewing the Installed Policy
Use the Management Console or a browser to display installed Central, Local, or Forward
policy files.
Note: You can view VPM policy files through the Visual Policy Files tab.

To view Installed policy:
1.

Select Configuration > Policy > Policy Files > Policy Files.

2.

In the View File drop-down list, select Current Policy to view the installed and running
policy, as assembled from all policy source files. You can also select Results of Policy
Load to view any warnings or errors resulting from the last attempt (successful or not)
to install policy.

3.

Click View. The SG appliance opens a separate browser window and displays the
installed policy file.

To view the currently installed policy through a browser:
1.

Enter a URL in one of the following formats:
•

If an HTTPS-Console is configured, use https://SG_ip_address:HTTPSConsole_port/Policy/current (the default port is 8082).

•

If an HTTP-Console is configured, use http://SG_ip_address:HTTPConsole_port/Policy/current (the default port is 8081).

The SG appliance opens a separate browser window and displays the policy.
2.

Review the policy, then close the browser.

Viewing Policy Source Files
You can display source (uncompiled) policy files on the SG appliance.
To view policy source files:
1.

Select Configuration > Policy > Policy Files > Policy Files.

2.

To view a policy source file, select the file you want to view (Local, Forward, or
Central) from the View File drop-down list and click View.
The SG appliance opens a separate browser window and displays the appropriate
source policy file.

Viewing Policy Statistics
You can view policy statistics on all requests processed by the SG appliance. Use the
Management Console or a browser. You cannot view policy statistics through the CLI.
To review policy statistics:
1.

Select Statistics > Advanced.

2.

Click the Policy link.

3.

Click the Show policy statistics link.
A separate browser window opens and displays the statistics.

24

Chapter 2: Managing Policy Files

4.

Examine the statistics, then close the browser.

25

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
To review policy statistics through a browser:
1.

Enter a URL in one of the following formats:
•

If an HTTPS-Console is configured, use https://SG_ip_address:HTTPSConsole_port/Policy/statistics (the default port is 8082).

•

If an HTTP-Console is configured, use http://SG_ip_address:HTTPConsole_port/Policy/statistics (the default port is 8081).

The SG appliance opens a separate browser window and displays the statistics.
2.

Examine the statistics, then close the browser.

Related CLI Syntax to Manage Policy Files
SGOS#(config) policy order v l c
SGOS#(config) policy proxy-default {allow | deny}
SGOS# policy trace {all | none}
SGOS#(config) inline policy file end-of-input-marker
SGOS#(config) policy subscribe
SGOS#(config) policy notify:
SGOS#(config) show policy
SGOS#(config) show configuration
-orSGOS#(config) show sources policy {central | local | forward | vpm-cpl |
vpm-xml}

26

Chapter 3: The Visual Policy Manager

The Visual Policy Manager (VPM) is a graphical policy editor included with the SG
appliance. The VPM allows you to define Web access and resource control policies
without having an in-depth knowledge of Blue Coat Content Policy Language (CPL)
and without the need to manually edit policy files.
This chapter serves as a VPM object reference, and assumes that you are familiar with
basic concepts of SG appliance policy functionality as described in Chapter 2,
Managing Policy Files.
While VPM creates only a subset of everything you can achieve by writing policies
directly in CPL, it is sufficient for most purposes. If your needs require more advanced
policies, consult Volume 10: Blue Coat SG Appliance Content Policy Language Guide.
This chapter contains the following sections:
❐

Section A: "About the Visual Policy Manager" on page 28

❐

Section B: "Policy Layer and Rule Object Reference" on page 38

❐

Section C: "Detailed Object Column Reference" on page 49

❐

Section D: "Managing Policy Layers, Rules, and Files" on page 139

❐

Section E: "Tutorials" on page 149

Related topics:
❐

Chapter 2: "Managing Policy Files"

❐

Volume 7: Managing Content

❐

Volume 10: Blue Coat SG Appliance Content Policy Language Guide

27

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section A: About the Visual Policy Manager
Table 3-1. VPM Menu Bar Items (Continued)
Configuration

View

Help

Set DNS Lookup Restrictions

Restricts DNS lookups during policy evaluation.

Set Reverse DNS Lookup Restrictions

Restricts reverse DNS lookups during policy
evaluation.

Set Group Log Order

Configures the order in which the group
information is logged.

Edit Categories

Edits content filtering categories.

Generated CPL

Displays the CPL generated by VPM.

Current SG Appliance VPM Policy
Files

Displays the currently stored VPM policy files.

Object Occurrences

Lists the user-created object(s) in the selected
rule; lists use in other rules as well.

All Objects

Displays a dialog that lists current static and
user-defined VPM objects. You can also create,
edit, and delete objects. See “Centralized
Object Viewing and Managing” on page 131.

Tool Tips

Toggles the tool-tip display on and off.

Help Topics

Displays the online help.

About

Displays copyright and version information.

Tool Bar
The VPM Tool Bar contains the following functions:
❐

Add Rule—Adds a blank rule to visible policy layer; all values for the rule are the

defaults.
❐

Delete Rule—Deletes the selected rule from the visible policy layer.

❐

Move Up—Moves a rule up one position in the visible policy layer.

❐

Move Down—Moves a rule down one position in the visible policy layer.

❐

Install Policy—Converts the policies created in VPM into Blue Coat Content Policy
Language (CPL) and installs them on the SG appliance.

Policy Layer Tabs
Every policy layer you create from the Policy > Add Layer menu is displayed as a tab. Click
a tab and the rules included in that policy layer display below in the main body of the
pane. Right-clicking a tab displays the options of disable or enabling, renaming, and
deleting the policy layer.

30

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section A: About the Visual Policy Manager
For example, the SG appliance has two ICAP response services installed, A and B. In the
Management Console, you remove service B, but do not click Apply. You then start the
VPM and view the ICAP Response Services object. Only service A is viewable and
selectable.
The VPM synchronizes the latest change from the Management Console when the
following occur:
❐

Clicking Revert.

❐

Clicking Apply.

❐

Clicking Policy Install.

❐

Restart the Management Console.

❐

Log out and re-log into the Management Console.

Any information the Management Console acquires from installable lists is immediately
available in the VPM. The following are the lists the VPM obtains from the Management
Console:
❐

Access Log fields.

❐

Authentication character sets.

❐

Authentication realms.

❐

Bandwidth gain classes.

❐

Categories.

❐

Exceptions.

❐

Forwarding hosts.

❐

ICAP request and response services.

❐

Keyrings.

❐

SOCKS gateways.

❐

Websense filter services.

About VPM Components
This section describes the specific policy layer types and rule objects.

Policy Layers
The layers are:
❐

Administration Authentication—Determines how administrators accessing SG

appliance must authenticate.
❐

Administration Access—Determines who can access the SG appliance to perform

administration tasks.
❐

DNS Access—Determines how the SG appliance processes DNS requests.

❐

SOCKS Authentication—Determines the method of authentication for accessing the

proxy through SOCKS.
❐

SSL Intercept—Determines whether to tunnel or intercept HTTPS traffic.

32

Chapter 3: The Visual Policy Manager

Section A: About the Visual Policy Manager
❐

SSL Access—Determines the allow/deny actions for HTTPS traffic.

❐

Web Authentication—Determines whether user clients that access the proxy or the
Web must authenticate.

❐

Web Access—Determines what clients can and cannot access on the Web and specifies
any restrictions that apply.

❐

Web Content—Determines caching behavior, such as verification and ICAP

redirection.
❐

Forwarding—Determines forwarding hosts and methods.

As you create policy layers, you will create many different layers of the same type. Often,
an overall policy requires layers of different types designed to work together to perform a
task. For example, Authentication and Access layers usually accompany each other; an
Authentication layer determines if a user or client must authenticate, and an Access layer
subsequently determines where that user or client can go (what SG appliance or Web sites
they can access) once they are authenticated.
Each object type is described in “Policy Layer and Rule Object Reference” on page 38.

Rule Objects
Policy layers contain rule objects. Only the objects available for that policy layer type are
displayed. There are two types of objects:
❐

Static Objects—A self-contained object that cannot be edited or removed. For
example, if you write a rule that prohibits users from accessing a specific Web site, the
Action object you select is Deny.
Static objects are part of the system and are always displayed.

❐

Configurable Objects—A configurable object requires parameters. For example,
consider the rule mentioned in the previous item that prohibits users from accessing a
specific Web site. In this case, the user is a Source object. That object can be a specific
IP Address, user, group, user agent (such as a specific browser), and so on. Select one
and then enter the required information (such as a verifiable user name or group
name).
Configurable objects do not exist until you create them. A created object is listed along
with all static objects in the list dialog, and you can reuse it in other applicable policy
layers. For example, an IP address can be a Source or Destination object in many
different policy-layer types.
Important: The orders of policy layers, and the order of rules within a layer are
important. For more information, see “How Policy Layers, Rules, and Files Interact”
on page 139.

While individual object-type menus occasionally contain entries specific to the object
type, the basic menu options are:
❐

Allow—(Web Access Layer Action column only) Quick menu access; sets the policy to
allow.

❐

Deny—(Web Access Layer Action column only) Quick menu access; sets the policy to

deny.
❐

Set—Displays the Set Object dialog where you select an object or create a new one.

33

Chapter 3: The Visual Policy Manager

Section A: About the Visual Policy Manager

Policy Layer/Object Matrix
The following table displays which object types are available in each policy layer.
.

Table 3-3. Available Object Types
Policy Layer

Source

Destination

Service

Time

Action

Track

Comment

Admin
Authentication

x

x

x

x

Admin Access

x

x

x

x

DNS Access

x

x

x

x

SOCKS
Authentication

x

x

x

x

SSL Intercept

x

x

x

x

x

SSL Access

x

x

x

x

x

Web Authentication

x

x

x

x

x

Web Access

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

Web Content
Forwarding

x

x

x

x

x

The Set Object Dialog
This section discusses the Set Object dialog used to select objects for configuration.
The object rules in all policy layer types determine the conditions for a particular policy
rule. Depending on the type of policy layer, an object can be anything from a user or
group to an IP address or a URL and so forth.
To create a rule, right-click a cell in an object cell. The relevant Set Object dialog displays.
In this dialog, select the objects for the rule or create new objects as necessary.
Objects have type-specific icons to provide a visual aid in distinguishing among different
types in the list.

35

Chapter 3: The Visual Policy Manager

Section A: About the Visual Policy Manager

The Add/Edit Object Dialog
From the Set Object dialog, the Add Object dialog is used to define configurable objects.
Existing configurable options can be altered using the Edit Object dialog. In terms of
functionality, the two dialogs are identical.
For the initial configuration of an object, click New on the Set Object dialog to display the
Add Object dialog. Perform the tasks required to configure the object and click OK. The
newly named and configured object appears in the list of selectable objects in the Set
Object dialog and is ready to be selected for the rule.
To edit an existing object, select an object from the list and click Edit. The Edit Object
dialog appears with the existing parameters on display. Edit as necessary and click OK.
To remove an existing object, select an object from the list and click Remove. A secondary
prompt verifies your attempt to remove the object; click OK. The object is deleted.

Online Help
The VPM contains its own Help module (a porting of this chapter). Each object in the
VPM contains a Help button that links to the corresponding object reference in the Help
file. This reference describes the purpose of the object. Interaction with other policy and
references to feature-related sections in the Blue Coat Configuration and Management Guide
Suite volumes are provided, if relevant. Also, this Help module contains navigation
buttons and its own Table of Contents.
Note: The online Help file is displayed in a separate window and requires a few seconds
to load and scroll to the correct object. The speed of your system might impact this slight
lag time. Furthermore, this lag time increases on slower machines running JRE v1.5.

37

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference

Section B: Policy Layer and Rule Object Reference
This section contains the following topics:
❐

“About the Reference Tables” —Describes the table conventions used in this section.

❐

“Administration Authentication Policy Layer Reference” —Describes the objects
available in this policy layer.

❐

“Administration Access Policy Layer Reference” —Describes the objects available in
this policy layer.

❐

“DNS Access Policy Layer Reference” —Describes the objects available in this policy
layer.

❐

“SOCKS Authentication Policy Layer Reference” —Describes the objects available in
this policy layer.

❐

“SSL Intercept Layer Reference” —Describes the objects available in this policy layer.

❐

“SSL Access Layer Reference” —Describes the objects available in this policy layer.

❐

“Web Authentication Policy Layer Reference” —Describes the objects available in this
policy layer.

❐

“Web Access Policy Layer Reference” —Describes the objects available in this policy
layer.

❐

“Web Content Policy Layer Reference” —Describes the objects available in this policy
layer.

❐

“Forwarding Policy Layer Reference” —Describes the objects available in this policy
layer.

About the Reference Tables
The tables in this section list the static and configurable objects available for each policy
layer.
Note: If viewing this document as a PDF, you can click an object name to jump to a
description of that object (all objects are described in Section C). To jump back to a specific
policy layer reference, click policy layer name in any object reference table that appears in
the next section.

Administration Authentication Policy Layer Reference
The following table provides the objects available in the Administration Authentication
policy layer.
Source Objects

Action Objects

Track Objects

Client IP Address/Subnet

Do Not Authenticate

Trace

Client Hostname

Deny

Proxy IP Address/Port

Authenticate

Combined Objects

Force Authenticate

38

Chapter 3: The Visual Policy Manager

Section B: Policy Layer and Rule Object Reference

Administration Access Policy Layer Reference
The following table provides the objects available in the Administration Access policy
layer.
Source Objects

Service Objects

Action Objects

Track Objects

Client IP Address/
Subnet

Service Name

Allow Read-Only Access

Event Log

Client Hostname

Allow Read-Write
Access

Email

Proxy IP Address/Port

Deny

SNMP

User

Log Out/Do Not Log Out
Other Users With Same
IP

Trace

Group

Log Out/Do Not Log Out
User

Combined
Objects

Attribute

Log Out/Do Not Log Out
User’s Other Sessions

User Login Address

Force Deny

User Login Time

Set Authorization Refresh
Time

User Login Count

Set Credential Refresh
Time

Client Address Login
Count

Set Surrogate Refresh
Time

Combined Objects

Combined Objects

DNS Access Policy Layer Reference
The following table provides the objects available in the DNS Access policy layer.
Source Objects

Destination Objects

Time Objects

Action Objects

Track Objects

Client IP Address/
Subnet

DNS Response
Contains No Data

Time

Bypass DNS
Cache

Event Log

Proxy IP Address/
Port

DNS Response IP
Address/Subnet

Combined
Objects

Do Not Bypass
DNS Cache

Email

DNS Request
Name

RDNS Response
Host

Allow DNS From
Upstream Server

SNMP

RDNS Request IP
Address/Subnet

DNS Response
CNAME

Serve DNS Only
From Cache

Trace

DNS Request
Opcode

DNS Response Code

Enable/Disable
DNS Imputing

Combined
Objects

39

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Time Objects

Action Objects

DNS Request
Class

Category

Send DNS/RDNS
Response Code

DNS Request
Type

Server Connection
DSCP Trigger

Send DNS
Response

DNS Client
Transport

Combined Objects

Send Reverse
DNS Response

Client Connection
DSCP Trigger

Reflect IP

Combined
Objects

Manage
Bandwidth

Track Objects

Set Client
Connection DSCP
Value
Set Server
Connection DSCP
Value
Combined Objects

SOCKS Authentication Policy Layer Reference
The following table provides the objects available in the SOCKS Authentication policy
layer.
Source Objects

Action Objects

Track Objects

Client IP Address/Subnet

Do Not Authenticate

Trace

Client Hostname

Authenticate

Proxy IP Address/Port

Force Authenticate

SOCKS Version
Combined Objects

SSL Intercept Layer Reference
The following table provides the objects available in the SSL Forward Proxy policy layer.
Source Objects

Destination Objects

Action Objects

Track Objects

Client Hostname
Unavailable

Destination IP Address/
Subnet

Enable HTTPS
Intercept

Event Log

Client Hostname

Destination Host/
Port

Enable HTTPS
Intercept on Exception

Email

Proxy IP Address/Port

Request URL

Combined Objects

SNMP

40

Chapter 3: The Visual Policy Manager

Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Action Objects

Track Objects

Combined Objects

Request URL Category

Trace

Server URL

Combined Objects

Server Certificate
Server Certificate
Category
Combined Objects

SSL Access Layer Reference
The following table provides the objects available in the SSL Access Layer policy layer.
Source Objects

Destination Objects

Service Objects

Action Objects

Track
Objects

Authenticated User

Destination IP
Address/Subnet

Request
Forwarded

Allow

Event Log

Client Hostname
Unavailable

Destination Host/
Port

Client Protocol

Deny (static)

Email

Guest User

Request URL

SSL Proxy Mode

Require/Do Not
Require Client
Certificate

SNMP

Client IP Address/
Subnet

Request URL
Category

Health Check

Force Deny

Trace

Client Hostname

Server URL

Combined
Objects

Force Deny
(Content Filter)

Combined
Objects

Proxy IP Address/
Port

Server Certificate

Deny

User

Server Certificate
Category

Return Exception

Group

Server Certificate

Set Client
Certificate
Validation

Attribute

Server Certificate
Category

Set Server
Certificate
Validation

User Login
Address

Server Negotiated
Cipher

Combined Objects

User Authentication
Error

Server Negotiated
Cipher Strength

User Authorization
Error

Server Negotiated
SSL Version

Client Certificate

Combined Objects

41

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Service Objects

Action Objects

Track
Objects

Client Negotiated
Cipher
Client Negotiated
Cipher Strength
Client Negotiated
SSL Version
Combined Objects

Web Authentication Policy Layer Reference
The following table provides the objects available in the Web Authentication policy layer.
Source Objects

Destination Objects

Action Objects

Track Objects

Client Hostname
Unavailable

Destination IP Address/
Subnet

Do Not Authenticate

Trace

Client IP Address/
Subnet

Destination Host/
Port

Deny

Client Hostname

Request URL

Authenticate

Proxy IP Address/Port

Request URL Category

Authenticate Guest

User Agent

Combined Objects

Add Default Group

Request Header

Force Authenticate

Combined Objects

Authentication
Charset
Set IP Address For
Authentication
Permit Authentication
Error
Permit Authorization
Error
Combined Objects

42

Chapter 3: The Visual Policy Manager

Section B: Policy Layer and Rule Object Reference

Web Access Policy Layer Reference
The following table provides the objects available in the Web Access policy layer.
Web Access policy layers regulate, from a general to a granular level, who or what can
access specific Web locations or content.
❐

Users, groups, individual IP addresses, and subnets, as well as object lists comprised
of any combination of these, can be subject to rules.

❐

Rules can include access control for specific Web sites, specific content from any Web
site, individual IP addresses, and subnets.

❐

Actions taken can range from allowing and denying access to more finely tuned
changes or limitations.

❐

Rules can also be subject to day and time specifications and protocol, file type, and
agent delimiters.

Source Objects

Destination Objects

Service Objects

Time Objects

Action Objects

Track
Objects

Streaming Client

Destination IP
Address/Subnet

Using HTTP
Transparent
Authentication

Time

Allow

Event Log

Client Hostname
Unavailable

Destination Host/
Port

Virus Detected

Combined
Objects

Deny

Email

Guest User

Request URL

Client Protocol

Force Deny

Authenticated
User

Request URL
Category

Service Name

Bypass Cache

Client IP Address/
Subnet

File Extensions

Protocol
Methods

Do Not Bypass
Cache

Client Hostname

HTTP MIME Types

IM File Transfer

Check/Do Not
Check
Authorization

Trace

Proxy IP Address/
Port

Apparent Data Type

IM Message
Text

Always Verify

Combined
Objects

User

Response Code

IM Message
Reflection

Use Default
Verification

Group

Response Header

Streaming
Content Type

Block/Do Not
Block PopUp
Ads

Attribute

Response Data

ICAP Error Code

Force/Do Not
Force IWA for
Server Auth

User Login
Address

IM Buddy

Health Status

Log Out/Do Not
Log Out Other
Users With
Same IP

SNMP

43

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Service Objects

Time Objects

Action Objects

User Login Time

IM Chat Room

Combined
Objects

User Login Count

Server Connection
DSCP Trigger

Log Out/Do Not
Log Out User’s
Other Sessions

Client Address
Login Count

Combined Objects

Reflect/Do Not
Reflect IM
Messages

Track
Objects

Log Out/Do Not
Log Out User

User
Authentication
Error

Block/Do Not
Block IM
Encryption

User Authorization
Error

Support/Do Not
Support
Persistent Client
Requests

User Agent

Support/Do Not
Support
Persistent
Server
Requests

IM User Agent

Trust/Do Not
Trust
Destination IP

Request Header

Deny

SOCKS Version

Return
Exception

IM User

Return
Redirect

P2P Client

Send IM Alert

Client Negotiated
Cipher

Modify Access
Logging

Client Negotiated
Cipher Strength

Override Access
Log Field

Client Connection
DSCP Trigger

Rewrite Host

Combined
Objects

Reflect IP

P2P Client

Suppress
Header

44

Chapter 3: The Visual Policy Manager

Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Service Objects

Time Objects

Action Objects

Client Negotiated
Cipher

Control Request
Header/Control
Response
Header

Client Negotiated
Cipher Strength

Notify User

Client Connection
DSCP Trigger

Strip Active
Content

Combined
Objects

Set Client HTTP
Compression

Track
Objects

Set Server
HTTP
Compression
Manage
Bandwidth
Modify IM
Message
Return ICAP
Feedback
Set External
Filter Service
Set ICAP
Request Service
Set FTP
Connection
Set SOCKS
Acceleration
Disable SSL
Detection
Set Streaming
Max Bitrate
Set Client
Connection
DSCP Value
Set Server
Connection
DSCP Value
Set ADN
Connection
DSCP

45

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference
Source Objects

Destination Objects

Service Objects

Time Objects

Action Objects

Track
Objects

Set
Authorization
Refresh Time
Set Credential
Refresh Time
Set Surrogate
Refresh Time
Combined
Objects

Web Content Policy Layer Reference
The following table provides the objects available in the Web Content policy layer.
The Web Content policy layer applies to requests independent of user identity.
Content scanning policy layers scan requested URLs and file types for viruses and other
malicious code. You must have an ICAP service installed on the SG appliance to use this
policy type.
Destination Objects

Action Objects

Track Objects

Destination IP Address/Subnet

Check/Do Not Check Authorization

Event Log

Destination Host/Port

Always Verify

Request URL

Use Default Verification

Email

Request URL Category

Use Default Caching

SNMP

File Extensions

Do Not Cache

Trace

HTTP MIME Types

Force Cache

Combined Objects

Response Header

Mark/Do Not Mark As
Advertisement

Response Data

Support/Do Not Support Persistent
Server Requests

Server Connection DSCP Trigger

Enable/Disable Pipelining

Combined Objects

Set Dynamic Categorization
Set External Filter Service
Set Client HTTP Compression
Set Server HTTP Compression
Manage Bandwidth
Set ICAP Request Service
Set ICAP Response Service

46

Chapter 3: The Visual Policy Manager

Section B: Policy Layer and Rule Object Reference
Destination Objects

Action Objects

Track Objects

Set TTL
Modify Access Logging
Override Access Log Field
Set Server Connection DSCP Value
Combined Objects

Forwarding Policy Layer Reference
The following table provides the objects available in the Forwarding policy layer.
Source Objects

Destination Objects

Service Objects

Action Objects

Track
Objects

Streaming Client

Destination IP
Address/Subnet

Client Protocol

Send Direct

Trace

Authenticated
User

Destination Host/
Port

Health Check

Integrate/Do Not
Integrate New Hosts

Guest User

Server URL

Health Status

Connect Using ADN
When Possible/Do Not
Connect Using ADN

Client IP Address/
Subnet

Server Connection
DSCP Trigger

Combined Objects

Allow Content From
Origin Server

Client Hostname

Combined Objects

Serve Content Only
From Cache

Proxy IP Address/
Port

Select SOCKS
Gateway

User

Select Forwarding

Group

Reflect IP

Attribute

Manage Bandwidth

User Login
Address

ADN Server
Optimization

User Login Time

Set IM Transport

User Login Count

Set Streaming
Transport

Client Address
Login Count

Set ADN Connection
DSCP

User
Authentication
Error

Set Server Connection
DSCP Value

47

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Policy Layer and Rule Object Reference
Source Objects
User Authorization
Error

Destination Objects

Service Objects

Action Objects

Track
Objects

Combined Objects

SOCKS Version
P2P Client
Client Connection
DSCP Trigger
Combined Objects

48

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Section C: Detailed Object Column Reference
This section contains the following topics:
❐

“Source Column Object Reference” on page 49

❐

“Destination Column Object Reference” on page 66

❐

“Service Column Object Reference” on page 76

❐

“Time Column Object Reference” on page 82

❐

“Action Column Object Reference” on page 84

❐

“Track Object Column Reference” on page 125

❐

“Comment Object Reference” on page 128

❐

“Using Combined Objects” on page 128

❐

“Creating Categories” on page 134

Source Column Object Reference
A source object specifies the communication or Web transaction origin that is evaluated by
the policy. Not all policy layers contain the same source objects.

Important: Because of character limitations required by the generated CPL, only
alphanumeric, underscore, dash, ampersand, period, or forward slash characters can
be used to define a source object name.

Any
Applies to any source.

Streaming Client
This is a static object. This rule applies to any request from a streaming client.

Client Hostname Unavailable
This is a static object. This rule applies if the client IP address could not be looked up with
a reverse DNS query.

Authenticated User
This is a static object. This rule applies to any authenticated user.

Guest User
This is a static object. This rule applies to all guest users.

49

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Client IP Address/Subnet
Specifies the IP address and, optionally, a subnet mask of a client. The policy defined in
this rule applies only to this address or addresses on this subnet. This object is
automatically named using the prefix Client; for example, Client: 1.2.0.0/255.255.0.0.
Note: See “Combined Source Object” on page 64 for related information regarding this
source object.

Client Hostname
Specifies a reverse DNS hostname resolved in the reverse lookup of a client IP address.
Enter the host name and select matching criteria. This object is automatically named using
the prefix Client; for example, Client: host.com. If you select a matching qualifier, that
attribute is appended to the object in parentheses. For example, Client: host.com (RegEx).

Proxy IP Address/Port
Specifies the IP address and, optionally, a port on the SG appliance. The policy defined in
this rule applies only to this address or addresses with this subnet.

User
Specifies an individual user in the form of a verifiable username or login name. Enter a
user name and an authentication realm. The dialog then displays different information
depending on the type of authentication realm specified. Select the appropriate realm
from the drop-down list. Items in the list are taken from the realms configured by the
administrator in the SG appliance.
LDAP
You can optionally select a User Base DN from a drop-down list. Entries in the User Base
DN list come from those specified by the administrator in the SG appliance. You can also
edit an entry selected in the list, type a new one, or click Browse to manually select a
name. Edited names and new names are retained in the list. Notice in the Full Name field
that the VPM takes the User Attribute type specified by the administrator in the SG
appliance (cn= in the following illustration), and associates it with the user name and Base
DN entered here.
Important: When you configure a realm, the SG appliance assumes a default primary
user attribute (sAMAccountName for Active Directory; uid for Netscape/iPlanet
Directory Server/SunOne; cn for Novell NDS). You can accept the default or change
it. Whatever is entered there is what the VPM uses here, entering it in the Full Name
display field once a Base DN is selected.
If the primary user attribute specified in the SG appliance differs from the primary user
attribute specified in the directory server, enter the latter in the User field with the
appropriate value (in the format attribute=value). This replaces the entry in the Full Name
field. Examine the following screenshot. Assume that the organization uses phone as the
primary attribute in its LDAP directory:

50

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
Netegrity SiteMinder
Entries in this list are not prepopulated. You must enter a name in the User field. An
entered name is retained and can subsequently be selected and edited. Notice in the Full
Name field that VPM displays domain name and user name entered above.
Oracle COREid
Entries in this list are not prepopulated. You must enter a name in the User field. An
entered name is retained and can subsequently be selected and edited. Notice in the Full
Name field that VPM displays domain name and user name entered above.
Policy Substitution
Entries in this list are not prepopulated. You must enter a name in the User field. An
entered name is retained and can subsequently be selected and edited. Notice in the Full
Name field that VPM displays domain name and user name entered above.
Sequences
Entries in this list are not prepopulated. You must enter a name in the User field. An
entered name is retained and can subsequently be selected and edited. Notice in the Full
Name field that VPM displays domain name and user name entered above. From the
Member Realm drop-down list, select an authentication realm (already configured on the
SG appliance). Depending on the realm type, new fields appear.

Group
Specifies a verifiable group name. Enter a user group and an authentication realm. The
dialog then displays different information depending on the type of authentication realm
specified.
❐

Group field—Replace the default with a verifiable group name.

❐

Authentication Realm field—Select the appropriate realm from the drop-down list.
Items in the list are taken from the realms configured by the administrator in the SG
appliance.

•

LDAP—Entries in the Group Base DN list come from those specified by the
administrator in the SG appliance. You can also edit an entry selected in the list, or
type a new one. Edited names and new names are retained in the list. Notice in the
Full Name field that the VPM takes the User Attribute type specified by the
administrator in the SG appliance (cn= in the following illustration), and conjoins
it with the group name and Base DN entered here.

Important: When you create a group, the default attribute is cn= in the Full Name
display field.

53

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
To specify a User Authorization Error object:
1.

Select one of the following:
•

None: Authorization was attempted and no user errors occurred.

•

Any: Authorization was attempted a user error occurred.

•

Selected errors: Authorization was attempted and one of the selected errors

occurred.
2.

3.

If you selected Selected errors:
a.

Select one or more error types (use Control + Left-click to highlight multiple
errors).

b.

Click Add to move the errors to the Selected field.

c.

Name the object or accept the default name.

Click OK.

Note: If authorization fails and no default groups are added through policy (see Guest
Authentication and Default Groups), the group conditions always evaluate to false. Verify
group conditions if you permit authorization errors, especially in scenarios where users
are denied based on group membership.

DNS Request Name
Specifies a DNS request. Enter the host name and select matching criteria. This object is
automatically named using the prefix DNS; for example, DNS: host.com. If you select a
matching qualifier, that attribute is appended to the object in parentheses. For example,
DNS: host.com (RegEx).

RDNS Request IP Address/Subnet
Specifies the reverse DNS IP address and, optionally, a subnet mask. The policy defined in
this rule applies only to this address or addresses on this subnet. This object is
automatically named using the prefix RDNS; for example, RDNS: 5.6.0.0/255.255.0.0.

DNS Request Opcode
Specifies OPCODEs to represent in the DNS header.
To specify a DNS Request OPCODE object:
1.

In the Name field, enter a custom name or leave as is to accept the default.

2.

Select one or more of the OPCODEs.

3.

Click OK.

DNS Request Class
Specifies the DNS request class (QCLASS) properties.
To specify a DNS request class object:
1.

In the Name field, enter a custom name or leave as is to accept the default.

59

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
2.

Select one or more of the request classes.

3.

Click OK.

DNS Request Type
Specifies the DNS request types (QTYPE) attributes.
To specify a DNS Request Type object:
1.

In the Name field, enter a custom name or leave as is to accept the default.

2.

Select one or more of the request types.

3.

Click OK.

DNS Client Transport
Specifies the DNS client transport method, UDP or TCP.
To specify a DNS Client Transport object:
1.

Select UDP Transport or TCP Transport. This object is automatically named using the
prefix DNS; for example, DNS: Client Transport UDP.

2.

Click OK.

SOCKS Version
Specifies the SOCKS version, 4 or 5. This object is automatically named as SOCKSVersion4
or SOCKSVersion5.

User Agent
Specifies one or more agents a client might use to request content. The choices include
specific versions of: Microsoft Internet Explorer, Netscape Communicator, Microsoft
Windows Media Player and NetShow, Real Media RealPlayer and RealDownload, Apple
QuickTime, Opera, and Wget.
The policy defined in this rule applies to these selected agents. You can name this list and
create other custom lists to use with other policy layer rules.

60

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
3.

Click OK.

Client Negotiated Cipher
Allows the testing of the SSL cipher in use between the SG appliance and the browser.
Select a code from the drop-down list.
To specify a client negotiated cipher:
1.

In the Name field, enter a name for the object or accept the default.

2.

Select one or more cipher codes valid for this rule.

3.

Click OK.

Client Negotiated Cipher Strength
Tests the cipher strength between a SG appliance-to-browser (client) HTTPS connection.
To specify a client negotiated cipher strength:
1.
2.

In the Name field, enter a name for the object or accept the default.
Select one or more of the strength options valid for this rule Export, High, Medium, or
Low.

3.

Click OK.

Low, Medium, and High strength ciphers are not exportable.

Client Negotiated SSL Version
Tests the SSL version between a SG appliance-to-browser (client) HTTPS connection.
To specify a client negotiated SSL version:
1.
2.

In the Name field, enter a name for the object or accept the default.
Select one or more of the version options valid for this rule SSL 2.0, SSL 3.0, or TLS
1.0.

3.

Click OK.

Client Connection DSCP Trigger
Tests the inbound differentiated service code point (DSCP) value of primary client-to-SG
appliance connections. After testing DSCP bits (in the IP header), additional policy
dictates how to handle traffic associated with the type of service.

63

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Source Column/Policy Layer Matrix
The following matrix lists all of the Source column objects and indicates which policy
layer they apply to.
Object

Admin Admin DNS SOCKS SSL SSL
Auth
Acc
Acc Auth
Int
Acc

Web
Auth

Web Web Fwding
Acc Cont
x

Streaming Client
x

Client Hostname Unavailable

x

x

x

Authenticated User

x

x

Guest User

x

x

Client IP Address/Subnet

x

Client Hostname

x

Proxy IP Address/Port

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

User

x

x

x

x

Group

x

x

x

x

Attribute

x

x

x

x

User Login Address

x

x

x

x

User Authentication Error

x

x

x

User Authorization Error

x

x

x

User Login Time

x

x

x

x

User Login Count

x

x

x

x

Client Address Login Count

x

x

x

x

x

x

DNS Request Name

x

RDNS Request IP Address/Subnet

x

DNS Request Opcode

x

DNS Request Class

x

DNS Request Type

x

DNS Client Transport

x

SOCKS Version

x
x

User Agent

x

IM User Agent
x

Request Header
Client Certificate
IM User

x

x

x
x

65

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
Object

Admin Admin DNS SOCKS SSL SSL
Auth
Acc
Acc Auth
Int
Acc

Web
Auth

Web Web Fwding
Acc Cont
x

P2P Client
Client Negotiated Cipher

x

x

Client Negotiated Cipher Strength

x

x

Client Negotiated SSL Version

x
x

Client Connection DSCP Trigger
x

Combined Objects

x

x

x

x

x

x

x

x

x

x

x

Destination Column Object Reference
A destination object specifies the communication or Web traffic destination that is
evaluated by the policy. Not all policy layers contain the same destination objects.

Important: Because of character limitations required by the generated CPL, only
alphanumeric, underscore, dash, ampersand, period, or forward slash characters can
be used to define a destination object name.

Any
Applies to any destination.

DNS Response Contains No Data
This is a static object.

Destination IP Address/Subnet
Specifies the IP address and, optionally, a subnet mask of a destination server. The policy
defined in this rule only applies to this address only or addresses within this subnet. This
object is automatically named using the prefix Destination; for example, Destination:
1.2.0.0/255.255.0.0.

Destination Host/Port
Specifies the hostname or port of a destination server. The policy defined in this rule
applies to this host on this port only. Enter the host name and port number, and select
matching criteria. This object is automatically named using the prefix Destination; for
example, Destination: company.com:80.

Request URL
Applies to a URL request sent by the client to the SG appliance.
To check for a match against requested URL
Select an option and enter the required information in the fields:

66

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Server URL
This object is functions the same as the “Request URL” on page 66 object, but applies to a
URL sent from the SG appliance to a server. If the SG appliance is performing URL
rewrites, the URL sent from the client might change, which requires another URL
matching check.

Server Certificate
Allows testing of server certificate attributes to be used by the SG appliance-to-server
HTTPS connections. Select one of the options:
❐

Hostname: This is the hostname you want to match in the server certificate. After you
enter the hostname, select from the dropdown list one of the following: Exact Match,
Contains, At Beginning, At End, Domain, or Regex.

❐

Subject: This is the fully qualified subject name in the server certificate. After you
enter the subject, select from the dropdown list one of the following: Exact Match,
Contains, At Beginning, At End, Domain, or Regex.

Server Certificate Category
Functions the same as the “Request URL Category” on page 68 object, but the piece of
information used for matching and categorizing is the hostname in the server certificate.

Server Negotiated Cipher
Tests the cipher suites used in a SG appliance-to-server connection.
To specify a server-negotiated cipher:
1.

In the Name field, enter a name for the object or accept the default.

2.

Select one or more cipher codes valid for this rule.

3.

Click OK.

Server Negotiated Cipher Strength
Specifies the cipher strength between a SG appliance-to-server HTTPS connection.
To specify a server-negotiated cipher strength:
1.
2.

In the Name field, enter a name for the object or accept the default.
Select one or more of the strength options valid for this rule Export, High, Medium, or
Low.

3.

Click OK.

Low, Medium, and High strength ciphers are not exportable.

Server Negotiated SSL Version
Specifies the SSL version between a SG appliance-to-server HTTPS connection.
To specify a server-negotiated SSL version:
1.

In the Name field, enter a name for the object or accept the default.

70

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
2.

Select one or more of the strength options valid for this rule SSL 2.0, SSL 3.0, or TLS
1.0.

3.

Click OK.

File Extensions
Creates a list of file extensions. The rule is triggered for content with an extension
matching any on the list. You can create multiple lists that contain various extensions to
use in different rules. For example, create a list called Images, and select file extension
types such as GIF, JPEG, BMP, XPM, and so on.

HTTP MIME Types
Creates a list of HTTP MIME content types. The rule is triggered for content matching any
on the list. You can create multiple lists that contain various MIME types to use in
different rules. For example, create a list called MicrosoftApps, and select MIME types
application/vnd.ms-excel, application/vnd.ms-powerpoint, application/vnd.ms-project, and
application/vnd.works.
Note: If you require a MIME type not contained in this list, use a Request URL object that
uses the At End matching criteria.

Apparent Data Type
The options in this object identify data content associated with Microsoft DOS and
Windows executable files. When used in a deny policy, the purpose of this object to deny
executable downloads and block drive-by installation of spyware.
To specify apparent data type:
1.

In the Name field, enter a name for the object or accept the default.

2.

Select one or both of the following data types:

3.

•

DOS/Windows Executable: Any type of Windows executable file, such as .exe files
(the most common type of Microsoft executable file, which is self-extracting); .dll
files (also self-extracting, but require another executable file), and .ocx files
(ActiveX control files that can be installed if the browser security level is set to
low). Windows PE, LE, and NE executable types are recognized.

•

Microsoft Cabinet File: Although not executable themselves, .cab (cabinet) files
are used by spyware programs to propagate ActiveX controls. Code in HTML
pages reference .cab files, which, from the inside, instruct the browser to
download and extract ActiveX components.

Click OK.

Response Code
Specifies the rule applies to content responses containing a specific HTTP code. Select a
code from the drop-down list. You can name the rule object or accept the default name.

71

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
To specify DSCP values to test against inbound server connections:
1.

In the Name field, enter a name for the object or accept the default. This example
creates an object that tests for an IP Precedence of 2 or any Assured Forwarding Class
(AFC) of type 2 (for low, medium, and high drop rates).

2.

Select IP Precedence values (denoted by CS) and Assured Forwarding Classes
(Denoted by AF) as required).

3.

(Optional) Rather than select Precedence and AFC values, enter a DSCP value range.
The valid range is 0 to 63. Blue Coat does not recommend this option. Most
applications fit into one of the defined values.

For conceptual information about configuring the SG appliance to manipulate traffic
based on type of service, refer to "Managing QoS and Differential Services" on page 194.

Combined Destination Objects
Allows you to create an object that combines different destination types. Refer to “Using
Combined Objects” on page 128.

Destination Column/Policy Layer Matrix
The following matrix lists all of the Destination column objects and indicates which policy
layer they apply to.
Object

Admin Admin DNS SOCKS SSL
Auth
Acc
Acc Auth
Int

SSL
Acc

Web Web Web Fwding
Auth Acc Cont

Destination IP Address/Subnet

x

x

x

x

x

x

Destination Port

x

x

x

x

x

x

Request URL

x

x

x

x

x

x

Request URL Category

x

x

x

x

x

Server URL

x

x

Server Certificate

x

x

Server Certificate Category

x

x

File Extensions

x

x

HTTP MIME Types

x

x

Category

x

Server Negotiated Cipher

x

Server Negotiated Cipher Strength

x

Server Negotiated SSL Version

x

Apparent Data Type

x

Response Header

x

Response Code

x

75

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
Object

Admin Admin DNS SOCKS SSL
Auth
Acc
Acc Auth
Int

SSL
Acc

Web Web Web Fwding
Auth Acc Cont

Response Data

x

IM Buddy

x

IM Chat Room

x

DNS Response IP Address/
Subnet

x

RDNS Response Host

x

DNS Response CNAME

x

DNS Response Code

x

Server Connection DSCP Trigger

x

Combined Objects

x

x

x

x

x

x

x

x

Service Column Object Reference
A service object specifies a service type, such as a protocol, that is evaluated by the policy.
Not all policy layers contain the same service objects.
Important: Because of character limitations required by the generated CPL, only
alphanumeric, underscore, dash, ampersand, period, or forward slash characters can be
used to define a service object name.

Any
Applies to any service.

Using HTTP Transparent Authentication
This is a static object. The rule applies if the service is using HTTP transparent
authentication.

Virus Detected
This is a static object. The rule applies if ICAP scanning detects a virus.

Request Forwarded
This is a static object. Automatically created when upgrading from SGOS 4.2.x to SGOS
5.2.x. Refer to the Blue Coat SGOS 5.2 Upgrade/Downgrade Guide.

Client Protocol
Specifies the client protocol types and subsets. From the first drop-down list, select a type
from the drop-down list: CIFS, Endpoint Mapper, FTP, HTTP, HTTPS, Instant Messaging, P2P,
Shell, SOCKS, SSL, Streaming, or TCP Tunneling.

76

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Service Column/Policy Layer Matrix
The following matrix lists all of the Service column objects and indicates which policy
layer they apply to.
Object

Admin Admin DNS
Auth
Acc
Acc

SOCKS SSL
Auth
Int

SSL
Acc

Web Web
Auth Acc

Web
Cont

Fwding

x

x

x

x

x

Using HTTP Transparent
Authentication
x

Request Forwarded

x

Virus Detected
x

Client Protocol
x

Service Name

x
x
x

Protocol Methods
x

SSL Proxy Mode
IM File Transfer

x

IM Message Text

x

IM Message Reflection

x

Streaming Content Type

x

ICAP Error Code

x

Health Status

x

Health Check

x

Combined Objects

x

x
x

x

x

x

Time Column Object Reference
A time object specifies a block of time or time trigger that determines client access
regarding other parameters in the rule (such Web sites and content types). Currently, the
Time object is only applicable to the Web Access Layer.

Any
Applies anytime.

Time
Specifies the time restrictions.

82

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
6.

To specify a restriction that spans one or more months, select Enable; in the Specify
Annually-Recurring Date Restriction field, select the month and day ranges. This
calendar restriction applies every year unless the restriction is altered.
Overlapping months is allowed, similar to the behavior of day ranges in Step 3.

7.

To specify a one-time only restriction, select Enable; in the Specify Non-Recurring Date
Restriction field, select the year, month, and day ranges. This calendar restriction
applies only during the time specified and will not repeat.

8.

Click OK.

Combined Time Object
Allows you to combine a time object that adheres to multiple time restrictions. See “Using
Combined Objects” on page 128.

Time Column/Policy Layer Matrix
The following matrix lists all of the Time column objects and indicates which policy layer
they apply to.
Object

Admin Admin DNS
Auth
Acc
Acc

SOCKS SSL
Auth
Int

SSL
Acc

Web Web
Auth Acc

Time

x

x

Combined Objects

x

x

Web Fwding
Cont

Action Column Object Reference
An action object determines which action to take if other parameters, such as source,
destination, service, and time requirements validate the rule

Important: Because of character limitations required by the generated CPL, only
alphanumeric, underscore, and dash characters can be used to define an action object
name.

Allow
This is a static object. Selecting this overrides other related configurations and the
specified user requests are allowed.

Deny
This is a static object. Selecting this overrides other related configurations and denies the
specified user requests.

Force Deny
This is a static object. Forces a request to be denied, regardless if rules in subsequent layers
would have allowed the request.

84

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Force Deny (Content Filter)
This is a static objects Forces a request to be denied, regardless if rules in subsequent
layers would have allowed the request. In the access logs, the Content Filter moniker
allows you to identify policy denies based on content filtering versus other reasons.

Allow Content From Origin Server
This is a static object.

Connect Using ADN When Possible/Do Not Connect Using ADN
These are static objects. Connect Using ADN When Possible instructs the SG appliance to
use the byte caching tunnels (used in Application Delivery Network (ADN)
deployments). Do Not Connect Using ADN prevents the use of tunnel connections.

Allow Read-Only Access
This is a static object. Grants full access to view data on the appliance.

Allow Read-Write Access
This is a static object. Grants full access to view and manipulate data on the appliance.

Do Not Authenticate
This is a static object. Selecting this overrides other configurations and the specified users
are not authenticated when requesting content.

Authenticate
Creates an authentication object to verify users. An authentication realm must exist on the
SG appliance to be selected through VPM.
Note: In the SOCKS Authentication policy layer, the object is SOCKS Authenticate.

85

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

4.

•

Origin—The SG appliance acts like an OCS and issues OCS challenges. The
authenticated connection serves as the surrogate credential.

•

Origin IP—The SG appliance acts like an OCS and issues OCS challenges. The
client IP address is used as a surrogate credential.

•

Origin Cookie—For transparent proxies: for clients that understand cookies but do
not understand redirects; the SG appliance acts like an origin server and issues
origin server challenges. The surrogate credential is used.

•

Origin Cookie Redirect—For transparent forward proxies: the client is redirected
to a virtual URL to be authenticated, and cookies are used as the surrogate
credential. The SG appliance does not support origin-redirects with the
CONNECT method.

•

Origin IP Redirect—Significantly reduces security; only useful for reverse proxy
and when clients have unique IP addresses and do not understand cookies (or you
cannot set a cookie). Provides partial control of transparently intercepted HTTPS
requests. The client is redirected to a virtual URL to be authenticated, and the
client IP address is used as a surrogate credential. The SG appliance does not
support origin-redirects with the CONNECT method.

•

SG2—The mode is selected automatically, based on the request using the SGOS
2.x-defined rules.

(Optional) If you selected a Form mode in Step 3, the Authentication Form, New Pin
Form, and Query Form drop-down lists becomes active.
•

Authentication Form—When forms-based authentication is in use, this property
selects the form used to challenge the user.

•

New Pin Form—When forms-based authentication is in use, this selects the form to
prompt user to enter a new PIN.

•

Query Form—When forms-based authentication is in use, this selects the form to
display to the user when a yes/no questions needs to be answered.
Note: The New Pin Form and the Query Form are only used with RSA SecurID

authentication.
In most deployments, the default form settings should be adequate. However, if in
your enterprise you have customized authentication forms configured (on the SG
appliance Management Console: Configuration > Authentication > Forms), you can
select them from the drop-down lists. For example, HR_PIN.
5.

Click OK.

Users are prompted to provide a valid user name and password.

Authenticate Guest
Allows a user to be authenticated as a guest user. One scenario is to allow access to a user
who might otherwise be considered unauthenticated. Another is where no authentication
is required, but you want to track access. For more information, see the Controlling Access
to the Internet and Intranet chapter in Volume 4: Securing the Blue Coat SG Appliance.

87

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Note: In the SOCKS Authentication policy layer, the object is Force SOCKS Authenticate.

Bypass Cache
This is a static object. Prevents the cache from being queried when serving a proxy
request, and prevents the response from the origin server from being cached.

Do Not Bypass Cache
This is a static object. The SG appliance always checks if the destination is cached before
going to the origin server; also, the content is cached if cacheable.

Bypass DNS Cache
This is a static object. Prevents the request from querying the DNS cache list of resolved
lookup names or addresses.

Do Not Bypass DNS Cache
This is a static object. The SG appliance always queries the DNS cache list of resolved
lookup names or addresses.

Allow DNS From Upstream Server
This is a static object. Allows the SG appliance to send requests for data not currently
cached to DNS servers.

Serve DNS Only From Cache
This is a static object. Instructs the SG appliance to only serve a DNS request from content
that is already cached.

Enable/Disable DNS Imputing
These are static objects. If DNS imputing is enabled, the SG appliance appends the suffixes
in the DNS imputing list to host names looked up when the original name is not found.

Check/Do Not Check Authorization
These are static objects. These actions control whether or not the SG appliance forces a
request to be sent to an upstream server every time to check authorization, even if the
content is already cached. The check action is not usually required for upstream origin
content servers performing authentication, as the SG appliance automatically tracks
whether content required authentication in each case. However, it can be required when
an upstream proxy is performing proxy authentication because of the way some proxies
cache credential information, causing them not to reliably challenge every request. When
requests are directed to an upstream proxy which operates in this manner, enabling Check
Authorization ensures that all such requests are properly authorized by the upstream
proxy before the content is served from the local cache.

89

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Always Verify
This is a static object. Cached content is always verified for freshness for the sources,
destinations, or service specified in the rule. For example, the CEO and Executive Staff
always require content to be the most recent, but everyone else can be served from the
cache.

Use Default Verification
This is a static object. Overrides the Always Verify action and instructs the SG appliance to
use its default freshness verification.

Block/Do Not Block PopUp Ads
These are a static objects. Blocks or allows pop up windows. Blue Coat recommends
creating separate Web Access policy layers that only contain pop up blocking actions.
Furthermore, many Web applications require pop up windows. As it is unlikely that your
Intranet contains pages that pop up unwanted advertising windows, Blue Coat
recommends disabling pop up blocking for your Intranet. For example:
❐

Web Access rule 1: Specify the Intranet IP address and subnet mask in the Destination
column and select Do Not Block Popup Ads in the Action column.

❐

Web Access rule 2: Select Block Popup Ads in the Action column.

As you continue to modify policy, you can add more policy layers to block or allow
specific IP addresses, but the policy layer as defined in the Web Access rule 2 above must
always be positioned last. Blocking pop up ads is the default if a previous policy rule does
not trigger.
For more concept information about pop up windows, see Section A: "Blocking Pop Up
Windows" on page 170.

Force/Do Not Force IWA for Server Auth
These are static objects. When configured for explicit proxy, Internet Explorer (IE) does not
support an IWA challenge from an origin server. If Force IWA for Server Auth is applied,
the SG appliance converts the 401-type server authentication challenge to a 407-type
proxy authentication challenge, which IE supports. The SG appliance also converts the
resulting Proxy-Authentication headers in client requests to standard server authorization
headers, which allows an origin server IWA authentication challenge to pass through
when IE is explicitly proxied through the SG appliance.

Log Out/Do Not Log Out Other Users With Same IP
These are static objects. If more than one user is logged in at the IP address of the current
transaction, this property logs out all users from the current IP address except the user of
the current transaction.

Log Out/Do Not Log Out User
These are static objects. This property logs out the login referenced by the current
transaction.

90

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Log Out/Do Not Log Out User’s Other Sessions
These are static objects. If a user is logged in at more than one IP address, this property
logs out the user from all IP address except the IP address of the current transaction.

Reflect/Do Not Reflect IM Messages
These are static objects. IM traffic can be contained and restricted to the network so that it
never reaches the IM server. A hierarchy of SG appliances manage the traffic and routes it
depending on each SG appliance fail open and fail closed configurations. For detailed
information about this deployment, refer to the Instant Messaging chapter in Volume 3:
Web Communication Proxies.

Support/Do Not Support Persistent Client Requests
These are static objects. Allowing persistent connections to the SG appliance from clients
reduces load improves the all-around performance of the network. This object specifies
whether or not to allow persistent server connections.

Support/Do Not Support Persistent Server Requests
These are static objects. If the back-end authentication authority (such as LDAP, RADIUS,
or the BCAAA service) receives large numbers of requests, you can configure the SG
appliance to use persistent connections to the server. This dramatically reduces load on
the back-end authentication authority and improves the all-around performance of the
network. This object specifies whether or not to allow persistent server connections.

Block/Do Not Block IM Encryption
These are static objects. AOL IM provides the option for clients to send encrypted
messages through both standard messaging (through the IM service) and direct
connection messaging. These objects allow you to block or not block the ability to send
encrypted messages through AOL IM. For detailed information about security benefits of
this feature, refer to the Instant Messaging chapter in Volume 3: Web Communication
Proxies.

Require/Do Not Require Client Certificate
These are static objects. For the SSL Proxy, specifies whether a client (typically a browser)
certificate is required or not.
❐

In forward proxy deployments, this is used to either request consent certificates or to
support certificate realm authentication.

❐

In reverse proxy deployments, client certificates are requested for certificate realm
authentication.

Also, see “Set Client Certificate Validation” on page 93.

Trust/Do Not Trust Destination IP
These are static objects. The Trust Destination IP object instructs the SG appliance to trust
the IP address sent by the client, forgoing a DNS lookup. This is designed for transparent
and ADN deployments. Conversely, the Do Not Trust Destination IP instructs the SG
appliance to always perform a DNS lookup.

91

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
<body><a href="$(exception.details)" onclick="Accept();">Accept</
a></body>

You can also use a button image (the image resides on an external Web server, as in the
following example:
<body><a href="$(exception.details)" onclick="Accept();">
<img src=”http://server.com/images/accept.png”> </a> </body>

If you use an HTML editor to compose code, you can paste it into the VPM; however,
only copy the HTML from the <body> tag to the </body> tag.
4.

Under Notify mode, select an option that determines notification when visiting a new
Web site:
•

Notify once for all hosts—The notification page is displayed only once; this is used
for configuring compliance pages. This option uses a Virtual Notify URL. If you
must change the URL from the default value, please read the limitation section
following this procedure.
Note: This option might cause users to experience some noticeable Web

browsing slowness.
•

Notify only once for related domains—The notify page reappears each time the
user visits a new Web site; this is used for configuring coaching pages.
Note: This option interferes with some Web advertising banners. In some

cases, the notification page appears inside the banner. In other cases, banner ads
are disabled by javascript errors. To fix these problems, do not serve notification
pages for URLs that belong to the Web Advertising, Advertising, or Web Ads
category. The actual name of this category varies with the content filtering
vendor, and some vendors do not have an equivalent.
•

5.

Notify on every host—The notify page reappears each time the user visits a new
Web host. Blue Coat recommends that only highly experienced administrators
employ this option. In addition to breaking banner ads, as described above in the
previous option, this option, on some Internet Web sites, might cause Javascript
errors that impair the functionality of the site.

Under Notify users again, select an option that specifies when the notification expires
and re-notification is required:
•

At next browser session— The notification page does not reappear until the next
browser session. When a user reboots, logs out, or closes all Web browser
windows, this ends the browser session.

•

After (time interval)—Notification reoccurs after the defined elapsed time
(minutes or hours); this is useful for coaching.

•

After (specific time)—Notification reoccurs at a specific time of day. You can
specify an interval of days; this is useful for compliance.
Note: The time is referenced from the local workstation. If a compliance page is
configured, verify the workstations and SG appliance clocks are synchronized.

103

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
The above example creates a Notify Object with a custom message, set to display once a
day after 7 AM.
Interactivities and Workarounds
If you must change the default Virtual Notify URL, consider the following:
❐

The Virtual Notify URL consists of an HTTP domain name or IP address (http://); a
port number is optional.

❐

Do not use a host name that is explicitly defined as a trusted site on Internet Explorer 6
for Windows XP, Service Pack 2. Furthermore, only use domain names that contain
dots. If you use domain names that do not contain dots, the HTTP redirects generated
by the notification action causes Internet Explorer to display false warning messages
each time the user is redirected from an untrusted site to a trusted site, or the other
way around.

❐

For transparent proxy deployments, the domain name must be DNS-resolvable to an
IP address that is in the range of destination IP addresses that are routed to the SG
appliance.

Policy Interactions
This action generates CPL that might interfere with other policy or cause undesired
behavior. Enhancements will occur in future SGOS releases. For this release, consider the
following guidelines:
❐

Do not create VPM policy that modifies the Cookie request header.

❐

Do not create VPM policy that modifies the Set-Cookie and P3P response headers.

❐

Notification pages exist in the browser history. Therefore, if you click Accept and are
taken to the requested page, then click the back button, you get the notification page
again.

❐

If you have a chain of SG appliances, with different notification pages configured on
each appliance in the chain, then each notification page must have a different object
name.

Strip Active Content
Strips HTTP tags from specified active content HTML pages. For each item you select for
removal, you can also create a customized message that is displayed to the user.
Note: Pages served over an HTTPS tunneled connection are encrypted, so the content
cannot be modified.

See Chapter 4: Advanced Policy, Section B: "Stripping or Replacing Active Content" on
page 172 for detailed information about the different types of active content.

104

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Set Server HTTP Compression
Enables or disables HTTP compression.
To specify compression options:
1.

In the Name field, enter name for the object or leave as is to accept the default.

2.

Select a compression option:
•
•

Disable HTTP compression—The default. Objects are not compressed.
Use client HTTP compression options—Default to the type of content requested by

the client.
•

Always request HTTP compression—Force clients to always request compressed

content.
3.

Click OK.

For recommended compression configurations, refer to Volume 2: Proxies and Proxy
Services.

Manage Bandwidth
Allows you to manage bandwidth for all protocols or specific protocols, on both inbound
and outbound traffic.
To create a manage bandwidth object:
1.

In the Name field, enter name for the object or leave as is to accept the default.

2.

Select to limit bandwidth on the: Client side or Server side.

3.

•

Client side—Traffic flowing between a client and the SG appliance.

•

Server side—Traffic flowing between a server and the SG appliance.

Select to limit bandwidth for: Inbound or Outbound traffic.
•

Inbound—Network packets flowing into the SG appliance. Inbound traffic mainly
consists of packets originating at the origin content server (OCS) and sent to the
SG appliance to load a Web object and packets originating at the client and sent to
the SG appliance for Web requests.

•

Outbound—Network packets flowing out of the SG appliance. Outbound traffic
mainly consists of packets sent to the client in response to a Web request and
packets sent to an OCS or other service (such as a virus scanner) to request a
service.

4.

Select a Bandwidth Class from the drop-down list.

5.

Click OK; click Save Changes.

For complete information about Bandwidth Management, refer to Volume 5: Advanced
Networking.

ADN Server Optimization
Specifies whether byte caching is employed on either (branch or core) or both sides of an
Application Delivery Network connection (specified IP addresses in the rule). Byte
caching reduces WAN latency.

107

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
4.

Click OK.

Enter a time value (in seconds) that the SG appliance waits for content to be serviced from
the origin content server before displaying the page that instructs users an ICAP scan is in
progress.
Note: Patience pages display regardless of any pop up blocking policy that is in effect.

Patience page management and limitations are described in Volume 7: Managing Content.

Set Dynamic Categorization
Dynamic categorization extends the process of categorizing a URL. Traditional content
filtering involves searching of massive URL pattern databases, which are published by
vendors and downloaded to the SG appliance at specified intervals. As new content
constantly reaches the Web, the limitation is that it cannot be filtered until its existence is
discovered, added, and uploaded. Dynamic categorization enhances content filtering by
scanning a new Web page, attempting to determine its contents, and categorizing
accordingly in real time.
When an un-categorized page is first encountered, the SG appliance calls an external
service with a categorization request. Once the content is scanned, a category is assigned
(a majority of the time).
For related information, refer to the Content Filtering chapter in Volume 7: Managing
Content.
To configure dynamic categorization:
1.

2.

Select a mode:
•

Do not categorize dynamically—The loaded database is consulted for category
information. URLs not in the database show up as category none.

•

Categorize dynamically in the background—Objects not categorized by the
database are dynamically categorized as time permits. Proxy requests are not
blocked while DRTR is consulted. Objects not found in the database appear as
category pending, indicating that DRTR was requested, but the object was served
before the DRTR response was available.

•

Categorize dynamically in realtime—The default. Objects not categorized by the
database are dynamically categorized on first access. If this entails consulting the
DRTR service, the proxy request is blocked until DRTR responds.

•

Use dynamic categorizing setting from configuration—Default to the SG appliance
configuration (Content Filtering>Blue Coat>Dynamic Categorization).

Click OK.

Set External Filter Service
Specifies which installed content filtering service or service group a content request is
subjected to or bypasses, and specifies what occurs if a communication error occurs
between the SG appliance and the external service.

110

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
Click OK.

Set Authorization Refresh Time
Realms that support authorization and authentication separately use the authorization
refresh time value to manage the load on the authorization server. These realms include:
Local, LDAP, Windows SSO, Novell SSO, Certificate, XML and Policy Substitution. They
determine authorization data (group membership, attribute values) separately from
authentication, allowing the time the authorization data is trusted to be increased or
decreased.
For realms that must authenticate the user to determine authorization data, the
authorization data is updated only when the user credentials are verified with the
authentication server.

Set Credential Refresh Time
The credential refresh time value determines how long a cache username and password is
trusted. After that time has expired, new transactions that require credential
authentication result in a request to the authentication server. A password different than
the cached password also results in a request to the authentication server.
This value can is only valid for realms that cache the username and password on the
proxy and realms that use Basic username and password credentials: LDAP, RADIUS,
XML, IWA (with Basic credentials), SiteMinder, and COREid.

Set Surrogate Refresh Time
Specifies how long surrogate credentials are trusted in a particular realm.

Send DNS/RDNS Response Code
Specifies to send out the default response code or a selectable error response code.
Perform one of the following:
❐

Select Send Default DNS Response; optionally, enter a TTL (time to live) value.

❐

Select Send Error Response Code and select a code from the drop-down list.

Send DNS Response
Specifies which IP address to return for a specified host.

116

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Force Cache
This is a static object. Specifies that (cacheable) objects are always cached. Objects that are
not cacheable (for example, RealMedia file types) and supported in pass-through mode
only are not cached.

Use Default Caching
This is a static object. Overrides the Do Not Cache and Force Cache actions and instructs
the SG appliance to use its default determination of whether or not to cache the content.

Mark/Do Not Mark As Advertisement
These are static objects. Specifies content to be identified as an advertisement. The SG
appliance still fetches content from the cache (if present); however, just after serving to the
client, the content is re-fetched from the ad server so that hit counters are updated.

Enable/Disable Pipelining
These are static objects. Enables or disables the SG appliance pipelining feature, which,
when enabled, examines Web pages for embedded objects and requests them from the
origin server in anticipation of a client request.

Set TTL
Specifies the time-to-live (TTL) an object is stored in the SG appliance. In the Name field,
enter a name for the object (or leave as is to accept the default); in the TTL field, enter the
amount of time in seconds.

Send Direct
This is a static object. Overrides forwarding host, SOCKS gateway, or ICP configurations
and instructs the SG appliance to request the content directly from the origin server.

Integrate/Do Not Integrate New Hosts
This is a static object. Used in server accelerator deployments. When enabled, the
corresponding host that is accessed is added to the list of hosts for which the SG appliance
performs health checks. If that host name resolves to multiple IP addresses that
correspond to different servers, the SG appliance fetches content from the available
servers and ignores the servers that fail the health check.

Allow Content From Origin Server
This is a static object. Allows request to access content from an origin server if the content
is not cached.

Serve Content Only From Cache
This is a static object. Requests to access content that is not cached are denied. If the
content is cached, the content is served.

118

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference

Select SOCKS Gateway
Specifies which SOCKS gateway, if any, to use; defines behavior if communication
between the SOCKS gateway and the SG appliance is down.
❐

To instruct the rule to connect directly without routing through a SOCKS service,
select Do not use SOCKS gateway.

❐

To instruct the rule to connect through a SOCKS gateway, select Use SOCKS Gateway
and select an installed SOCKS service from the drop-down list.
In the If no SOCKS gateway is available field, select Deny the request or Connect
directly, which allows requests to bypass the SOCKS service.

Select Forwarding
Specifies which forwarding host or group, if any, to use; defines behavior if
communication between the forwarding and the SG appliance is down.
❐

To instruct the rule to connect directly without redirecting to a forwarding host or
group, select Do not forward.

❐

To instruct the rule to redirect to a forwarding host, select Use Forwarding and select
an installed forwarding host from the drop-down list.
In the If no forwarding is available field, select Deny the request (fail closed) or Connect
directly (fail open), which allows requests to bypass the forwarding host.

❐

To instruct the rule to forward using the ICP configuration, select Forward using ICP.

Server Byte Caching
Specifies whether byte caching is employed on either (branch or core) or both sides of an
Application Delivery Network connection (specified IP addresses in the rule). Byte
caching reduces WAN latency.
❐

Optimize traffic in both directions: Apply Byte Caching to traffic coming and leaving

the server.
❐

Optimize only inbound traffic: Apply Byte Caching only to traffic coming into the

server.
❐

Optimize only outbound traffic: Apply Byte Caching only to traffic leaving the server.

❐

Do not optimize traffic: Do not allow Byte Caching on specified connections.

Set IM Transport
Specifies the transport method used for IM traffic.
❐

Auto—Connects using the transport method used by the client.

❐

HTTP—Tunnels the IM requests over HTTP.

❐

Native—Connects using the native transport used by the service.

Set Streaming Transport
Specifies which streaming transport method the rule uses.

119

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
❐

The user.authorization_error=any evaluates to true if user authorization failed
and the user object contains username and domain information, but not group or
attribute information. As a result, policy using user or domain actions still match, but
policy using group or attribute conditions do not.

Combined Action Objects
Allows you to combine an action object that invokes multiple actions. See “Using
Combined Objects” on page 128.

Action Column/Policy Layer Matrix
The following matrix lists all of the Action column objects and indicates which policy layer
they apply to.
Object

Admin Admin DNS SOCKS SSL
Auth
Acc
Acc Auth
Int

x

Allow
Deny (static)

SSL Web Web Web Fwding
Acc Auth Acc Cont

x

x

Allow Read-Only Access

x

Allow Read-Write Access

x

x
x

Do Not Authenticate

x

x

x

Authenticate

x

x

x

Force Authenticate

x

x

x

x

Bypass Cache

x

Do Not Bypass Cache

x

Check Authorization

x

x

Do Not Check Authorization

x

x

Always Verify

x

x

Use Default Verification

x

x

Block Up Ads

x

Do Not Block PopUp Ads

x

Force IWA For Server Auth

x

Do Not Force IWA For Server Auth

x

Require Client Certificate

x

Do Not Require Client Certificate

x

Reflect IM Messages

x

Do Not Reflect IM Messages

x

Block IM Encryption

x

123

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
Object

Admin Admin DNS SOCKS SSL
Auth
Acc
Acc Auth
Int

SSL Web Web Web Fwding
Acc Auth Acc Cont

Do Not Block IM Encryption

x

Trust Destination IP

x
x

Not Trust Destination IP
Deny

x

x

Return Exception

x

x
x

Return Redirect
Set Client Certificate Validation

x

Set Server Certificate Validation

x

Set HTTPS Intercept

x

Set HTTPS Intercept on Exception

x

Send IM Alert

x

Modify Access Logging

x

x

Override Access Log Field

x

x

Rewrite Host

x

Reflect IP

x

x

Suppress Header

x

Control Request Header

x

Control Response Header

x

Notify User

x

Strip Active Content

x

Set Client HTTP Compression

x
x

ADN Server Optimization
Set Server HTTP Compression

x

Modify IM Message

x

Return ICAP Feedback

x
x

Set Dynamic Categorization
Set External Filter Service

x

Set ICAP Request Service

x

x

Set ICAP Response Service

x

Use Default Caching

x

Set FTP Connection

x

124

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
Object

Admin Admin DNS SOCKS SSL
Auth
Acc
Acc Auth
Int

SSL Web Web Web Fwding
Acc Auth Acc Cont

Set SOCKS Acceleration

x

Set Streaming Max Bitrate

x

Client Connection DSCP Value

x

x

Server Connection DSCP Value

x

x

Send DNS/RDNS Response Code

x

Send DNS Response

x

Send Reverse DNS Response

x

x

Do Not Cache

x

Force Cache

x

Mark As Advertisement

x

Do Not Mark as Advertisement

x

Enable Pipelining

x

Disable Pipelining

x

Set TTL

x

x

Send Direct

x

Integrate New Hosts

x

Do Not Integrate New Hosts

x

Allow Content From Origin Server

x

Serve Content Only From Cache

x

Select SOCKS Gateway

x

Select Forwarding

x

Reflect IP

x

Set IM Transport

x

Set Streaming Transport

x
x

Authentication Charset
Combined Objects

x

x

x

x

x

x

Track Object Column Reference
A track object defines the parameters for tracking and tracing traffic. All policy layers
contain the same trace objects, but tracking parameters are layer-specific.

125

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
5.

Optional: Add substitution variables. The substitution variables instruct the SG
appliance to append specific information to the tracking object. The variables are
categorized alphabetically, according to prefix.
Note: Some variables do not have prefixes.

In the Substitution Variables field:
a.
b.

From the Category drop-down list, select a category to narrow the view to a
subset of variables.
The Display Option options allow you to further aggregate the variables by
ELFF (Extended Log File Format) or CPL (Content Policy Language).

c.

Select a variable and click Insert. Rolling the mouse over a variable displays a
brief description of the variable. Repeat as required.

Tracing Objects
This object specifies rule and Web traffic tracing.
Click Trace Level and select one of the following trace options:
❐

No Tracing—The default.

❐

Request Tracing—Generates trace output for the current request. The trace output

contains request parameters (such as URL and client address), the final values of
property settings, and descriptions of all actions taken.
❐

Rule and Request—Generates trace output that displays each rule that was executed

❐

Verbose Tracing—Generates the same output as Rule and Request, but also lists which

rules were skipped because one or more of their conditions were false, and displays
the specific condition in the rule that was false.
Furthermore, a trace destination can be entered that specifies the destination for any trace
produced by the current transaction. To specify a destination path, select Trace File and
enter a path in the field. For example, abc.html.
If a trace destination is configured in multiple layers, the actual trace destination value
displayed is the one specified in the last layer that had a rule evaluated (which has a
destination property configured). Consider the following multiple Web Access Layer
example, demonstrated by the generated CPL:
<Proxy>
url.domain=aol.com trace.request(yes) trace.rules(all)
trace.destination("aol_tracing.html")
url.domain=msn.com trace.request(yes)
trace.rules(all)trace.destination("msn_tracing.html")
<Proxy>
client.address=10.10.10.1 trace.request(yes) trace.rules(all)

The resulting actions are:
❐

Requests to the aol.com domain are logged to aol_tracing.html.

❐

Requests to the msn.com domain are logged to msn_tracing.html.

❐

Requests from the client with the IP of 10.10.10.1 are logged to the default location
of default.html.

127

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference
.

Note: After using a trace to troubleshoot, remove the trace to save log space.

The Trace File option can be used in conjunction or separately from the Trace Level option.
The default path of the trace file is accessible through one of the following URLs.
If the Management Console secure mode is enabled (the default on a new or upgraded
system):
https://SG_appliance_IP_address:8082/Policy/Trace/default_trace.html

If the Management Console is deployed in non-secure mode:
http://SG_appliance_address:8081/Policy/Trace/default_trace.html

Combined Track Object
Allows you to combine track objects into one. See “Using Combined Objects” on page 128.

Track Objects/Policy Layer Matrix
The following matrix lists all of the Track and column objects and indicates which policy
layer they apply to.
Object

Admin Admin DNS
Auth
Acc
Acc

SOCKS SSL
Auth
Int

SSL
Acc

Web Web Web
Auth Acc Cont

Event Log

x

x

x

x

x

x

Email Log

x

x

x

x

x

x

SNMP Objects

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

x

Trace
Combined Objects

x

x

Fwding

x

Comment Object Reference
The Comment object allows you to write any text to aid in labeling the policy layer. The
text in this field does not impact the policy.

Using Combined Objects
As previously discussed, you select one object for as many object types as required for a
given rule. Most object types also have the option of using a combined object. This feature
allows you to select multiple objects for a given type, thus creating more complex tools.
There are two uses for combined conditions: lists and multiple object types. Also consider
the Negate option, which exempts the objects in the list.
Example One
Consider the following example. You want a Web Content policy layer that as an action
forces authorization and sends the response to an ICAP service for content scanning.

128

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Note: If other administrators have access to the SG appliance through other
workstations and are creating categories either through VPM or with inline
commands, consider that newly-created or edited categories are not synchronized
until the policy is installed. When the policy is installed with VPM, the categories are
refreshed. If too many categories are created at the same time and confusion occurs,
select the File > Revert to Existing Policy on SG Appliance option to restore the policy
to the previous state and reconfigure categories.

Refreshing Policy
In between occurrences when either VPM is closed and reopened or Install Policies is
invoked, VPM does not recognize changes to VPM-managed policy that were made on the
SG appliance through another method. For example:
❐

Another administrator opens a separate VPM to make changes.

❐

Another administrator edits the local or central policy file through the serial console.

❐

Another administrator makes edits the local or central policy file.

❐

A new content filter database is downloaded automatically and the new update
contains category changes.

❐

A new content filter database is downloaded manually by an administrator.

Restricting DNS Lookups
This section discusses DNS lookup restrictions and describes how to create a list.

About DNS Lookup Restriction
The DNS lookup restriction list is a list of domain names that apply globally, regardless of
policy layer definitions. Once a domain name is added to the list, DNS lookup requests do
not occur for that domain name while policy is evaluated. For more detailed information
about using DNS lookups, refer to Volume 10: Blue Coat SG Appliance Content Policy
Language Guide.

Creating the DNS Lookup Restriction List
The list is created from the VPM Menu bar.
To create the DNS lookup restriction list:
1.

Select Configuration > Set DNS Lookup Restrictions; the Set DNS lookup restrictions
dialog appears.
The default is None; no domain names are restricted.

2.

To restrict every domain name, select All.

3.

To add specific domain names, perform the following steps.

136

Chapter 3: The Visual Policy Manager

Section C: Detailed Object Column Reference
a.

Select Listed Host Patterns. This enables the Host Patterns field.

b.

Click Add; the Add Host Pattern dialog appears.

c.

Enter a domain name; click OK.

d. Repeat to add other domain names.
e.

Click OK.

Restricting Reverse DNS Lookups
This section discusses reverse DNS lookup restrictions and describes how to create a list.

About Reverse DNS Lookup Restriction
The Reverse DNS lookup restriction list is a list of subnets that apply globally, regardless
of policy layer definitions. Once a subnet is added to the list, the SG appliance will not
perform a reverse lookup of addresses on that subnet during policy evaluation. For more
detailed information about using reverse DNS lookups, refer to Volume 10: Blue Coat SG
Appliance Content Policy Language Guide.

Creating the Reverse DNS Lookup Restriction List
The list is created from the VPM Menu bar. This prevents the SG appliance from
performing reverse DNS lookups of addresses in the list while evaluating policy.
To create the reverse DNS lookup restriction list:
1.

Select Configuration > Set Reverse DNS Lookup Restrictions; the Set Reverse DNS
lookup restrictions dialog appears.
The default is None; no subnets are restricted.

2.

To restrict every subnet, select All.

3.

To add specific subnets, perform the following steps.
a.

Select Listed Subnets.
This enables the Subnets field.

b.

Click Add; the Add Subnet dialog appears.

c.

Enter a subnet; click OK.

d. Repeat to add other subnets.
e.

Click OK.

Setting the Group Log Order
This section discusses the group log order and describes how to create a list.

About the Group Log Order
The Group Log Order object allows you to establish the order group data appears in the
access logs. For more detailed information about using group log ordering, refer to Volume
10: Blue Coat SG Appliance Content Policy Language Guide.

137

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section C: Detailed Object Column Reference

Creating the Group Log Order List
The list is created from the VPM Menu bar.
To create the group log order list:
1.

Select Configuration > Set Group Log Order; the Set Group Log Order dialog appears.

2.

Click Add; the Add Group Object dialog appears.

3.

In the Group Name field, enter the name of a group.
The group must be already configured on the SG appliance.

4.

From the Authentication Realm drop-down list, select a realm.

5.

Click OK.

6.

Repeat as required to add more groups.

7.

To order the list, select a group and click Move Up or Move Down until you achieve the
desired order.

8.

Click OK.

138

Chapter 3: The Visual Policy Manager

Section D: Managing Policy Layers, Rules, and Files

Section D: Managing Policy Layers, Rules, and Files
This section contains the following topics:
❐

“How Policy Layers, Rules, and Files Interact” —Describes the importance of rule
order policy layer order.

❐

“Managing Policy” —Describes how to save and install policies on the SG appliance.

❐

“Installing VPM-Created Policy Files” —Describes how to propagate a policy file
created on one SG appliance to another.

❐

“Viewing the Policy/Created CPL” —Describes how to view the underlying CPL that
is created with VPM.

How Policy Layers, Rules, and Files Interact
The following critical points discuss the behaviors and priorities of policy rules, layers,
and files:
❐

Rules in different policy layers of the same type work together, and the order of policy
layers is important.

❐

The order of policy layers of different types is important.

❐

The order of rules in a policy layer is important.

❐

Policy created in VPM is saved in a file on the SG appliance; the state of the VPM user
interface is also stored as an XML file on the SG appliance.
Note: These files are stored only if the policy is installed without any errors.

❐

How the appliance evaluates those rules in relation to policy layers that exist in the
central and local policy files is important. For more information, see Chapter 2:
"Managing Policy Files" on page 15.

How VPM Layers Relate to CPL Layers
VPM generates CPL in various layers, but the concept of layers presented in VPM is
slightly different. VPM provides policy layers for special purposes. For example, Web
Authentication and Web Authorization, which both generate CPL <Proxy> layers. This
minimizes timing conflicts by restricting the choices of conditions and properties to those
compatible timing requirements. The following table summarizes how to use VPM layers
and which CPL layers result.
Table 3-4. VPM-Generated CPL Layers
Policy Purpose

VPM Layer

CPL Layer

Establish Administrator identities.

Admin Authentication

<Admin>

Control Administrator access.

Admin Authorization

<Admin>

Control DNS access.

DNS Access

<DNS>

Establish SOCKS user identities.

SOCKS Authentication

<Proxy>

139

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Managing Policy Layers, Rules, and Files
Table 3-4. VPM-Generated CPL Layers (Continued)
Policy Purpose

VPM Layer

CPL Layer

Allow HTTPS interception.

SSL Intercept

<SSLIntercept>

Control HTTPS traffic.

SSL Access

<SSL>

Establish user identities.

Web Authentication

<Proxy>

Control user access.

Web Access

<Proxy>

Control content independent of
users.

Web Content

<Cache>

Control forwarding.

Forwarding

<Forward>

Note: VPM currently does not support the <Exception> layer.

Ordering Rules in a Policy Layer
The SG appliance evaluates the rules in the order in which they are listed in a policy layer.
When it finds a rule that applies to the situation, it skips the remaining rules in the policy
layer and goes on to the next policy layer.
Consider the following simple example. Assume that a company has a policy that
prohibits everyone from accessing the Web. This is a policy that is easy to create with a
Web Access layer rule.
There are, however, likely to be exceptions to such a broad policy. For example, you
require the manager of the purchasing department to be able to access the Web sites of
suppliers. Members of the sales department need to access their customer Web sites.
Creating Web Access rules for both these situations is also simple. But if you put all these
rules in a single policy layer, then the rule prohibiting access to everyone must be ordered
last, or the other two rules are not applied.
Principle Design Rule:
Always go from the specific to the general.

Using Policy Layers of the Same Type
Because the SG appliance skips the remaining rules in a policy layer as soon as it finds one
that meets the condition, multiple policy layers and a combination of rules might be
required to accomplish a task.
Consider the following example. A company does not want to prohibit its employees from
accessing the Web, but it does not want them to abuse the privilege. To this end, the
company wants employees who access the Web to authenticate when they do so; that is,
enter a username and password. So the company creates a Web Authentication policy
layer with a rule that says: “If anyone from anywhere in the company sends a request to a
URL on the Web, authenticate the client before granting access.”

140

Chapter 3: The Visual Policy Manager

Section D: Managing Policy Layers, Rules, and Files
The company also allows members of the group Sales to access various sports Web sites
only during non-work hours. Given the Web Authentication rule above, these people
must authenticate when they do this. But the company feels that it is not important for
people going to these sites after hours to authenticate. So the company creates the
following Web Access policy-layer rule:
❐

Grant Sales personnel access to sports Web sites from 5:00 PM to midnight.
But there are additional issues. Some members of the sales department spend a lot of
time watching game highlights on video clips, and this takes up a lot of bandwidth.
At the same time, a lot of customers access the company Web site in the evening
(during non-work hours), so internal bandwidth should remain manageable. The
company, therefore, limits the bandwidth available to the people in the Sales
department with a Web Access layer rule that is identical to the one above in all
respects except for the action:

❐

Grant Sales personnel access to sports Web sites from 5:00 PM to midnight, but limit
the maximum streaming bitrate to 300 kilobits per second.

For both these rules to work, they need to be in separate policy layers. If they were in the
same policy layer, the rule listed second would never be applied.

Ordering Policy Layers
The order of policy layers is also important. The SG appliance evaluates policy layers in
the order in which they are listed in VPM. When the SG appliance is going through policy
layers, it does not execute a given rule as soon as it finds that it meets the specific
situation. Rather, it compiles a list of all the rules that meet the condition; when it has gone
through all the policy layers, it evaluates the list, resolves any apparent conflicts, and then
executes the required actions. If there is a conflict between rules in different policy layers,
the matching rule in the policy layer evaluated last takes precedence.
In the above example, there are two Web Access policy layers: one contains a rule stating
that Sales personnel can access certain Web sites without authenticating, and the other
states that when they do access these Web sites, limit the available bandwidth. The order
of these policy layers is irrelevant. The order is irrelevant because there is no conflict
between the rules in the layers.
The following is an example in which the order of policy layers does matter. Assume all
URL requests from members of the purchasing department are directed to a single proxy
server. To discourage employees from surfing the Web excessively during business hours,
a company creates a Web Authentication Policy rule that says: “Whenever a client request
comes in to the proxy server, prompt the client to authenticate.”
Members of the purchasing department, however, need to access specific Web sites for
business reasons, and the company does not want to require authentication every time
they do this. So they create a Web Access policy rule that says: “If any member of the
purchasing department sends a request to a specific URL contained in a combined-object
list, allow access.”
The policy layer with the first rule needs to come first in evaluation order; it is then
overridden by the second rule in a subsequent policy layer.
Principle Policy Layer Design Rule
Always go from the general to the specific; that is, establish a general rule in an early
policy layer, then write exception rules in later policy layers.

141

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Managing Policy Layers, Rules, and Files
Notes
The Category and Notify User objects and the DNS Lookup Restrictions, Reverse DNS
Lookup Restrictions, and Group Log Order configuration objects generate CPL, regardless
if they are or are not included in rules. These specific objects and features allow users to
edit categories and lists that might or might not be used in current policies.

Managing Policy
This section describes how to manage VPM policy.

Refreshing Policy
In between occurrences when either VPM is closed and reopened or Install Policies is
invoked, VPM does not recognize changes to VPM-managed policy that were made on the
SG appliance through another method. For example:
❐

Another administrator opens a separate VPM to make changes.

❐

Another administrator edits the local or central policy file through the serial console.

❐

Another administrator makes edits the local or central policy file.

❐

A new content filter database is downloaded automatically and the new update
contains category changes.

❐

A new content filter database is downloaded manually by an administrator.

Reverting to a Previous Policy
If after creating new policies or editing an existing policy you decide to abandon the
process and continue with the existing policy installed on the SG appliance, you can revert
to that version. All current changes are deleted (VPM provides a verification prompt).
To revert to an existing installed policy:
Select File > Revert to Existing Policy on SG Appliance.

Changing Policies
You can change, edit, delete, add to, and otherwise manage policies created in VPM at any
time by returning to VPM and working with policy layers and rules just as you did when
creating them.

Managing Policy Layers
This section describes how to perform edits of policy layers.

Renaming a Policy Layer
The VPM allows you to rename policy layers and disable and re-enable layers.
To rename a policy layer:
1.

Right-click the tab of the policy layer and select Rename. The Rename New Layer
dialog appears.

2.

Rename the layer and click OK.

144

Chapter 3: The Visual Policy Manager

Section D: Managing Policy Layers, Rules, and Files

Disabling a Policy Layer
Disabling policy layers allows you to remove a subset of the employed policy without
losing the rules and the effort put forth to create them. Once disabled, the policy in that
layers is ignored. You can re-enable a disabled layer at any time.
To disable or enable a policy layer:
Right-click the tab of the policy layer and select Disable Layer. The layer name text turns
red and the layer rules are greyed-out.
To re-enable a layer, repeat this step and select Enable Layer.

Deleting a Policy Layer
You can completely remove a policy layer.

Important: Once deleted, a layer cannot be recovered.
To delete a policy layer:
1.

Right-click the tab of the policy layer to be deleted.

2.

Select Delete Policy from the drop-down list.

Note: All of the above procedures can be accomplished from the Menu Bar>Edit dropdown list.

Managing Policy Rules
Occasionally, you might need to temporarily disable rules in a policy layer; for example,
when troubleshooting compiles errors and warnings. This might help confirm that the SG
appliance can successfully compile the remaining policy. After disabling a rule, you can
edit the objects and re-enable the rule.
To disable or enable a rule:
1.

Click the appropriate policy layer tab.

2.

Right-click in the No. column.

3.

Click Disable Rule on the shortcut menu. The policy editor changes the rule text color
to red.

4.

To enable the rule, repeat step 3. After you enable a disabled rule, the policy editor
changes the rule text color to black.

Installing VPM-Created Policy Files
Policies created with VPM are saved on the specific SG appliance on which they are
created. SGOS automatically creates the following files when saving VPM-created
policies:
config_policy_source.xml
config_policy_source.txt

145

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Managing Policy Layers, Rules, and Files
1.

At the config command prompt, enter the following commands:
SGOS#(config) policy vpm-cpl-path url
SGOS#(config) load policy vpm-cpl

2.

At the config command prompt, enter the following commands:
SGOS#(config) policy vpm-xml-path url
SGOS#(config) load policy vpm-xml

Viewing the Policy/Created CPL
View the CPL generated by installing VPM-created policy from VPM or the Management
Console.
To view the generated CPL through the VPM:
Select View > Generated CPL.
To view the VPM policy file:
Select View > Current SG Appliance VPM Policy Files.

Important: Do not edit or alter VPM-generated files by opening the VPM policy file
and working in the generated CPL. To edit, change, or add to VPM policies, edit the
policy layers and re-install the policy.

148

Chapter 4: Advanced Policy Tasks

This chapter provides conceptual and procedural information about the SG appliance
advanced policy features. While many SG appliance features have a policy component,
some features have no configuration component outside policy. Configuring advanced
policy is accomplished by defining rules in the Visual Policy Manager (VPM) or by
composing Content Policy Language (CPL). While some examples are provided in this
chapter, references to the relevant VPM chapter component are included in each
section.
This chapter contains the following topics:
❐

Section A: "Blocking Pop Up Windows" on page 170

❐

Section B: "Stripping or Replacing Active Content" on page 172

❐

Section C: "Modifying Headers" on page 175

❐

Section D: "Defining Exceptions" on page 176

❐

Section E: "Managing Peer-to-Peer Services" on page 188

❐

Section F: "Managing QoS and Differential Services" on page 194

Excluding exceptions, you must use policy to implement these capabilities. (For
exceptions, you can create a list outside of policy to install on the system.)

169

Chapter 4: Advanced Policy Tasks

Section A: Blocking Pop Up Windows
•

Users—When a pop up window is blocked, a message is displayed in the status
bar:
blocked popup window -- use CTRL Refresh to see all popups.

While pressing the Control key, click the Web browser Refresh button; the page is
reloaded with pop up blocking disabled for that action.
❐

Create a separate Web Access policy layer for pop up blocking actions. This alleviates
interference with Web applications deployed on your Intranet that require pop up
windows.

❐

To prevent a cached Web page from spawning pop up windows, clear the browser
cache, then reload the page without holding down the CTRL key.

Blocking pop up windows is accomplished through the Visual Policy Manager. See
“Block/Do Not Block PopUp Ads” on page 90 for information about how to create
blocking actions in a policy layers.

171

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Stripping or Replacing Active Content

Section B: Stripping or Replacing Active Content
This section describes the Blue Coat solution for stripping or replacing unwanted active
content.

About Active Content
Scripts activated within Web pages can pose a security concern. The SG appliance policy
can be configured to supplement standard virus scanning of Web content by detecting and
removing the HTML tags that launch active content such as Java applets or scripts. In
addition, the removed content can be replaced with predefined material, a process
referred to as active content transformation.
When the SG appliance is configured to perform active content transformation, Web pages
requested by a client are scanned before they are served and any specified tags and the
content they define are either removed or replaced. Because the transformed content is not
cached, the transformation process is based on a variety of conditions, including time of
day, client identity, or URL.
Note: Pages served over an HTTPS tunneled connection are encrypted, so the content
cannot be modified.

The following tags and related content can be removed or replaced:
❐

<APPLET>—Java applets, as defined by HTML <applet> elements.

❐

<EMBED>—Embedded multimedia objects displayed using Netscape Navigator plugins as defined by HTML <embed> elements.

❐

<OBJECT>—Embedded multimedia objects displayed using Internet Explorer ActiveX controls and other multimedia elements, as defined by HTML <object> elements

❐

<SCRIPT>—Embedded Javascript and VBScript programs, whether these are
represented as HTML <script> elements, Javascript entities, Javascript URLs, or
event handler attributes. The <noscript> tag is not affected by this features.

Stripping active content is accomplished through the Visual Policy Manager or by
composing CPL.
❐

See “Strip Active Content” on page 104 for information about how to create a Strip
Active Content action object in a Web Access policy layer.

❐

Refer to Volume 10: Blue Coat SG Appliance Content Policy Language Guide.

About Active Content Types
The following sections provide more detail about the types of active content that can be
removed or replaced.

Script Tags
Scripts are generally placed between the start and end tags <SCRIPT> and </SCRIPT>.
The type of script used is defined by the LANGUAGE attribute; for example, <SCRIPT
LANGUAGE=”JavaScript 1.0”>). When the LANGUAGE attribute is undefined, the browser
assumes JavaScript.

172

Chapter 4: Advanced Policy Tasks

Section B: Stripping or Replacing Active Content
When transform active_content is configured to remove scripts, the basic operation is
to remove all content between and including <SCRIPT> and </SCRIPT>, regardless of the
language type, and substitute any defined replacement text. A notable exception occurs
when a script is defined in the header portion of the HTML document (defined by the
<HEAD> tag). In this case, the script is simply removed. This is because images, objects, and
text are not allowed in the header of an HTML document. If the end script tag </SCRIPT>
is missing from the document (the end of the document is defined as either up to the </
BODY> or </HTML> tag, or the last character of the document), then all content from the
start <SCRIPT> tag to the end of the document is removed.

JavaScript Entities
JavaScript entities have the following format: &{javascript code} and are found
anywhere in the value part of an attribute (that is, <IMG SRC=”&{images.logo};”). You
can define more than one entity in the value portion of the attribute. When transform
active_content is configured to remove scripts, all JavaScript entities attribute/value
pairs are removed. No replacement text is put in its place.

JavaScript Strings
JavaScript strings have the following format: javascript: javascript code and are
found anywhere in the value part of an attribute, though usually only one of them can be
defined in an attribute. Most modern browsers support JavaScript strings. When
transform active_content is configured to remove scripts, all JavaScript string
attribute/value pairs are removed. No replacement text is put in its place.

JavaScript Events
JavaScript events are attributes that start with the keyword on. For example, <A
HREF=”index.html onMouseOver=”javascript code”>. The HTML 4.01 specification
defines 21 different JavaScript events:
onBlur, onChange, onClick, onDblClick, onDragDrop, onFocus, onKeyDown,
onKeyPress, onKeyUp, onLoad, onMouseDown, onMouseMove, onMouseOut,
onMouseOver, onMouseUp, onMove, onReset, OnResize, onSelect, onSubmit,
onUnload

Both Microsoft Internet Explorer and Netscape have defined variations on these events as
well as many new events. To catch all JavaScript events, the active content transformer
identifies any attribute beginning with the keyword on, not including on itself. For
example, the attribute onDonner in the tag <A HREF=”index.html”
onDONNER=”DONNER”> is removed even though onDonner does not exist as a valid
JavaScript event in the browser. In this case, the transformed file would show <A
HREF=”index.html”>.

Embed Tags
HTML <EMBED> tags are not required to have an </EMBED> end tag. Many Web browsers
do, however, support the <EMBED> </EMBED> tag pair. The text between the tags is
supposed to be rendered by the browsers when there is no support for the embed tag, or if
the MIME-type of the embed object is not supported. Thus, when transform
active_content is configured to transform embed tags, only the <EMBED> tag is removed
and replaced with any replacement text. Any occurrence of the end tag </EMBED> is
simply removed, leaving the text between the beginning and end tags intact.

173

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section B: Stripping or Replacing Active Content

Object Tags
Objects tags have a start <OBJECT> and end </OBJECT> tag pair, and the attributes
CODETYPE and TYPE determine the type of object. The text between the tags is supposed to
be rendered by the browsers when the object tag is not supported, so when transform
active_content is configured to transform object tags, only the <OBJECT> and </
OBJECT> tags are removed and replaced with any replacement text. The text between the
tags remains. The CODETYPE or TYPE attributes do not affect the transformation. Also, if
the end </OBJECT> tag is missing, the transformation will not be affected.

174

Chapter 4: Advanced Policy Tasks

Section C: Modifying Headers

Section C: Modifying Headers
The request headers are sent when users access Web objects that contain a lot of
information. This can raise a concern that such details compromise the privacy or security
of the enterprise or user.
When a user clicks on a link, the Web browser sets the request’s Referer header to the URL
of the Web page that contained the link. (This header is not set if the URL was entered or
selected from a favorites or bookmarks list.) If an internal Web page provides links to
external Web sites, users clicking those links sends the URL of the internal pages, and are
logged in the Web logs of those external sites. This is not usually an issue; however, if the
external Web site is a competitor Web site or another site with interest in the internal
details of your enterprise, this might be a concern.
For example, how you structure your intranet might suggest something about your
company’s current or future direction. Certain project names or codewords might show
up in directory or file names. Exposing the structure of the intranet makes it easier for
hackers to attack the network.
The broad solution of deleting Referer headers from all requests presents a problem
because some Web sites do not serve images or other linked objects unless the Referer
header is set to a referring page on that same Web site. The solution implemented by Blue
Coat is to strip the Referer header only when the target Web page resides on the Internet
and the referring page is on an internal host.
Suppressing headers is accomplished through the Visual Policy Manager or by composing
CPL.
❐

See “Suppress Header” on page 99 for information about how to create a Suppress
Header action object in a Web Access policy layer.

❐

Refer to Volume 10: Blue Coat SG Appliance Content Policy Language Guide.

175

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Defining Exceptions

Section D: Defining Exceptions
Exceptions are sent in response to certain SG appliance client requests, such as denial by
policy, failure to handle the request, and authentication failure. Exceptions are returned to
users based on policy rules defined by the SG appliance administrator. For example, if a
client sends a request for content that is not allowed, an exception HTML page (for HTTP
connections) or an exceptions string (for non-HTTP connections) is returned, informing
the client that access is denied.
Two types of exceptions are used: built-in and user-defined.

Built-in Exceptions
Built-in exceptions are a set of pre-defined exceptions contained on the SG appliance.
Built-in exceptions send information back to the user under operational contexts that are
known to occur, such as policy_denied or invalid_request.
Built-in exceptions are always available and can also have their contents customized;
however, built-in exceptions cannot be deleted, and you cannot create new built-in
exceptions.
The table below lists the built-in exceptions and the context under which they are issued.
Table 4-1. Exceptions
Exception Type

Issued When

authentication_failed

The transaction cannot be authenticated, usually
because the credentials were incorrect.
authentication_failed is a synonym for
deny.unauthorized.

authentication_failed_
password_expired

The authentication server reports that the credentials
provided have expired, and a new password must be
obtained.

authentication_mode_not_
supported

The configured authentication mode is not supported
for the current request.

authentication_redirect_
from_virtual_host

Transparent redirect authentication is being used. This
exception redirects the transaction from the virtual
authentication host to the original request.

authentication_redirect_off_
box

The request is being redirected to an authentication
service on another device.

authentication_redirect_to_
virtual_host

Transparent redirect authentication is being used. This
exception redirects the transaction to the virtual
authentication host.

authentication_success

Transparent redirect authentication with cookies is
being used. This exception redirects the transaction to
the original request, but removes the authentication
cookie form the request URL.

176

Chapter 4: Advanced Policy Tasks

Section D: Defining Exceptions
Table 4-1. Exceptions (Continued)
Exception Type

Issued When

authorization_failed

The deny.unauthorized policy action is matched.
This exception notifies the user that their currently
authenticated identity is not permitted to perform the
requested operation, but they might have some other
credentials that would allow their request through (for
example. they get an opportunity to enter new
credentials).

client_failure_limit_
exceeded

Too many requests from your ip address
($(client.address)) have failed.

configuration_error

A configuration error on the SG appliance was
detected, and the requested operation could not be
handled because of the configuration error. This
exception is a likely indicator that the administrator of
the SG appliance must intervene to resolve the
problem.

connect_method_denied

A user attempted an CONNECT method to a nonstandard port when explicitly proxied. Blue Coat does
not allow CONNECT methods to non-standard ports
by default because it is considered a security risk to do
so.

content_filter_denied

A particular request is not permitted because of its
content categorization.

content_filter_unavailable

An external content-filtering service could not be
contacted, and the SG appliance is failing closed in
such a situation.

dns_server_failure

The request could not be processed because the SG
appliance was unable to communicate with the DNS
server in order to resolve the destination address of the
request.

dns_unresolved_hostname

The request could not be processed because the SG
appliance was unable to resolve the hostname in the
request with DNS.

dynamic_bypass_reload

The dynamic_bypass policy action is matched.

gateway_error

There was a network error while attempting to
communicate with the upstream gateway.

icap_communication_error

A network error occurred while the SG appliance was
attempting to communicate with an external ICAP
server.

internal_error

The SG appliance encountered an unexpected error
that resulted in the inability to handle the current
transaction.

invalid_auth_form

The submitted authentication form is invalid. The form
data must contain the username, password, and valid
original request information.

177

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Defining Exceptions
Table 4-1. Exceptions (Continued)
Exception Type

Issued When

invalid_request

The request received by the SG appliance was unable to
handle the request because it detected that there was
something fundamentally wrong with the syntax of the
request.

license_expired

The requested operation cannot proceed because it
would require the usage of an unlicensed feature.

method_denied

The requested operation utilizes a method that has
been explicitly denied because of the service properties
associated with the request.

not_implemented

The protocol cannot handle the requested operation
because it utilizes a feature that is not currently
implemented.

notify

Used internally by VPM. You do not need to customize
the text of this exception, since in this case the entire
HTML response is generated by VPM and is not taken
from the exception definition.

notify_missing_cookie

This exception is returned when a VPM Notify User
action is being used to notify the user, and the user has
disabled cookies in the Web browser.

policy_denied

policy_denied is a synonym for deny.

policy_redirect

A redirect action is matched in policy.

redirected_stored_requests_
not_supported

This applies to forms authentication with POST
requests only): The origin server returned a redirect for
the request. The SG appliance is configured to not
allow stored requests to be redirected.

refresh

A refresh (using the HTTP Refresh: header) is
required. The refresh exception (by default) refreshes
the originally requested URL (or in some cases, its postimputed form).

server_request_limit_
exceeded

Too many simultaneous requests are in progress to
$(url.host).

silent_denied

An exception(silent_denied) is matched in
policy. This exception is pre-defined to have no body
text, and is silent in that it results in only the status
code being sent to the client.

ssl_domain_invalid

There was a failure contacting an upstream host
through HTTPS because the certificate presented by the
upstream host was either the incorrect one or invalid.

ssl_failed

A secure connection could not be established to an
upstream host. This is typically because the upstream
host is not configured to accept SSL connections.

178

Chapter 4: Advanced Policy Tasks

Section D: Defining Exceptions
Table 4-1. Exceptions (Continued)
Exception Type

Issued When

tcp_error

A network error occurred attempting to communicate
with an upstream host.

transformation_error

The server sends an unknown encoding and the SG
appliance is configured to do content transformation.

unsupported_encoding

The client makes a request with an AcceptEncoding: Identity;q=0, … header. Only
uncompressed content is available in cache, the SG
appliance is not configured to compress the content, or
the compression license is expired, or the client request
results in to Accept-Encoding: Identity;q=0
because of the combination of request and configured
policy.

unsupported_protocol

The protocol used in the request is not understood.

Most of the above exceptions can be initiated directly through the policy exception
property. However, some require additional state that makes initiating them either
problematic or out of context. The following are exceptions that cannot be initiated
through the exception property:
❐

authentication_failed

❐

authentication_failed_password_expired

❐

authentication_redirect_from_virtual_host

❐

authentication_redirect_to_virtual_host

❐

authentication_success

❐

dynamic_bypass_reload

❐

license_expired

❐

ssl_domain_invalid

❐

ssl_failed

To view the content of a built-in exception, enter the following commands at the (config)
prompt:
SGOS#(config) exceptions
SGOS#(config exceptions) show exceptions configuration_error
configuration_error exception:
all protocols:
summary text:
SG configuration error
details text:
Your request could not be processed because of a configuration
error: $(exception.last_error)
help text:
The problem is most likely because of a configuration error,
$(exception.contact) and provide them with any pertinent information
from this message.
http protocol:
code: 403

179

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Defining Exceptions

User-Defined Exceptions
User-defined exceptions are created and deleted by the administrator. If a user-defined
exception is referenced by policy, it cannot be deleted. The default HTTP response code
for user-defined exceptions is 403.
Note: For users who are explicitly proxied and use Internet Explorer to request an
HTTPS URL, an exception body longer than 900 characters might be truncated. The
workaround is to shorten the exception body.

An exception body less than 512 characters might cause a page does not exist 404 error. If
this occurs, use the exception.autopad(yes|no) property to pad the body to more than
513 characters. For more information on the exception.autopad property, refer to the
Volume 10: Blue Coat SG Appliance Content Policy Language Guide.

About Exception Definitions
Each exception definition (whether built-in or user-defined) contains the following
elements:
❐

Identifier—Identifies the type of exception. Table 4-1 lists the built-in exception

types. For user-defined exceptions, the identifier is the name specified upon creation.
❐

Format—Defines the appearance of the exception. For an HTTP exception response,
the format is an HTML file. For other protocols, where the user agents are not able to
render HTML, the format is commonly a single line.

❐

Summary—A short description of the exception that labels the exception cause. For
example, the default policy_denied exception summary is “Access Denied”.

❐

Details—The default text that describes reason for displaying the exception. For
example, the default policy_denied exception (for the HTTP protocol) detail is: Your

request has been denied by system policy.
❐

Help—An informative description of common possible causes and potential solutions
for users to take. For example, if you want the categorization of a URL reviewed, you
can append the $(exception.category_review_url) and
$(exception.category_review_message) substitutions to the $(exception.help)
definition. You must first enable this capability through content filtering
configuration. For information on enabling review categorization, refer to Volume 7:
Managing Content.

❐

Contact—Used to configure site-specific contact information that can be substituted

in all exceptions. Although it is possible to customize contact information on a perexception basis, customizing the top-level contact information, which is used for all
exceptions, is sufficient in most environments.
❐

HTTP-Code—The HTTP response code to use when the exception is issued. For
example, the policy_denied exception by default returns the 403 Forbidden HTTP

response code.
Important: Fields other than Format must be less than 8000 characters. If they are
greater than this, they are not displayed.

180

Chapter 4: Advanced Policy Tasks

Section D: Defining Exceptions
When defining the above fields, you can use substitution variables that are particular to
the given request. Some of the above fields are also available as substitutions:
❐

$(exception.id)

❐

$(exception.summary)

❐

$(exception.details)

❐

$(exception.help)

❐

$(exception.contact)

Additionally, the Format, Summary, Details, Help and Contact fields can be configured
specifically for HTTP, or configured commonly for all protocols.
The Format field, the body of the exception, is not available as a substitution. However,
the Format field usually includes other substitutions. For example, the following is a
simple HTML format:
<html>
<title>$(exception.id): $(exception.summary)</title>
<body><pre>
Request: $(method) $(url)
Details: $(exception.details)
Help: $(exception.help)
Contact: $(exception.contact)
</pre></body></html>

Some additionally useful substitutions related to exceptions are:
❐

$(exception.last_error)—For certain requests, the SG appliance determines

additional details on why the exception was issued. This substitution includes that
extra information.
❐

$(exception.reason)—This substitution is determined internally by the SG

appliance when it terminates a transaction and indicates the reason that the
transaction was terminated. For example, a transaction that matches a DENY rule in
policy has its $(exception.reason) set to "Either 'deny' or 'exception' was
matched in policy".

About the Exceptions Hierarchy
Unlike the error pages in previous SGOS releases, exceptions are not required to have its
entire contents defined. Exceptions are stored in a hierarchical model, and parent
exceptions can provide default values for child exceptions. There are two parent
exceptions from which other exceptions are derived: exception.all and
exception.user-defined.all.
Each built-in and user-defined exception derives its default values from the all exception.
For example, by default the built-in exceptions do not define the format field. Instead,
they depend on the all exception's format field definition. To change the format text for
all built-in and user-defined exceptions, customize the format field for the all exception.
The user-defined.all exception is the parent of all user-defined exceptions, but it is also
a child of the all exception. Configuring exception.user-defined.all is only
necessary if you want certain fields to be common for all user-defined exceptions, but not
common for built-in exceptions.
The following example demonstrates using the exception inline command to configure
the $(exception.contact) substitution for every HTTP exception:

181

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Defining Exceptions
#(config exceptions) inline http contact EOF
For assistance, contact <a
href="mailto:sysadmin@example.com">sysadmin</a>EOF

The following example configures a different $(exception.contact) substitution for
every HTTP exception:
#(config exceptions) user-defined inline http contact EOF
For assistance, contact <a
href="mailto:policyadmin@example.com">policyadmin</a>EOF

About the Exceptions Installable List
The Exceptions Installable List uses the Structured Data Language (SDL) format. This
format provides an effective method to express a hierarchy of key/value pairs. For
example, the following is SDL file before customization:
(exception.all
(format "This is an exception: $(exception.details)")
(details "")
(exception.policy_denied
(format "")
(details "your request has been denied by system policy")
)

This SDL file defines an exception called policy_denied that defines the
$(exception.details) substitution as "Your request has been denied by system
policy". Because the exception does not define the format field, it inherits the format
field from its parent exception (exception.all). When the policy_denied exception is
issued, the resulting text is: This is an exception: your request has been denied
by system policy.
Suppose you want to customize the $(exception.contact) substitution for every HTTP
exception. Edit the exception.all component.
Note: The default HTTP format and built-in exception definitions have been removed for

example purposes.
(exception.all
(contact "For assistance, contact your network support team.")
(details "")
(format "$(exception.id): $(exception.details)")
(help "")
(summary "")
(http
(code "200")
(contact "")
(details "")
(format <<EOF
<format removed>
EOF
)
(help "")
(summary "")
)
<built-in exceptions removed>
)

182

Chapter 4: Advanced Policy Tasks

Section D: Defining Exceptions
To add the $(exception.contact) information, modify the contact substitution under
the http node:
(exception.all
(contact "For assistance, contact your network support team.")
(details "")
(format "$(exception.id): $(exception.details)")
(help "")
(summary "")
(http
(code "200")
(contact "For assistance, contact <a
href="mailto:sysadmin@example.com">sysadmin</a>")EOF
(details "")
(format <<EOF
<format removed>
EOF
)
(help "")
(summary "")
<built-in exceptions removed>
)
)

Keep in mind the following conditions when modifying exception installable lists:
❐

Every exception installable list must begin with a definition for exception.all.

❐

In the exceptions’ installable list, all definitions must be enclosed by
exception.all and its accompanying closing parenthesis; that is,
(exception.all
(exception.policy_denied)
)

❐

Keep the definition strings under the enclosed parentheses short, no longer than one
line if possible.

❐

Blue Coat strongly recommends downloading the existing exceptions installable list,
then modifying it.

Creating or Editing Exceptions
You can create or edit an exception with the CLI or with installable lists on the
Management Console.
Note: You cannot create user-defined exceptions for Patience Pages.

To create or edit an exception:
1.

At the (config) prompt, enter the following commands:
SGOS#(config) exceptions
SGOS#(config exceptions) create definition_name
SGOS#(config exceptions) edit definition_name
SGOS#(config exceptions user-defined.definition_name) http-code
numeric HTTP
response code
SGOS#(config exceptions user-defined.definition_name) inline ?

183

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section D: Defining Exceptions
contact
details
format
help
http
summary
SGOS#(config
eof
string eof
SGOS#(config
eof
string eof
SGOS#(config
eof
string eof
SGOS#(config
string eof
SGOS#(config
eof
string eof

2.

Set the $(exceptions.contact) substitution
Set the $(exceptions.details) substitution
Set the format for this exception
Set the $(exceptions.help) substitution
Configure substitution fields for just HTTP exceptions
Set the $(exception.summary) substitution
exceptions user-defined.definition_name) inline contact

exceptions user-defined.definition_name) inline details

exceptions user-defined.definition_name) inline format

exceptions user-defined.definition_name) inline help eof
exceptions user-defined definition_name) inline summary

(Optional) View the results.
SGOS#(config exceptions user-defined.test) show exceptions userdefined.test
$(exception.id):
test
$(exception.summary):
Connection failed
$(exception.details):
Connection failed with stack error
$(exception.contact):
Tech Support

To delete a user-defined exception:
From the (config) prompt, enter the following commands:
SGOS#(config) exceptions
SGOS#(config exceptions) delete exception_name
ok
Note: You cannot delete a user-defined exception that is referenced by policy.
You must remove the reference to the exception from the policy before deleting
the exception.

Creating and Installing an Exceptions List
The Management Console allows you to create and install exceptions with the following
methods:
❐

Using the SG appliance Text Editor, which allows you to customize the existing
exceptions file.

❐

Creating a local file on your local system; the SG appliance can browse to the alreadycreated file and install it.

184

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section E: Managing Peer-to-Peer Services

Section E: Managing Peer-to-Peer Services
This section describes the Blue Coat solution for managing and blocking peer-to-peer
traffic.

About Peer-to-Peer Communications
The use of peer-to-peer (P2P) technologies and services consumes an estimated 60% of
broadband ISP bandwidth. By design, most P2P services are port-agnostic, which makes
attempting to block them at the firewall extremely difficult. One peer finds another IP
address and port that is willing to share the file, but different peers can use different ports.
Furthermore, P2P is not based on any standards, which makes it nearly impossible for
network administrations to control or even detect.
Although P2P provides some practical business uses in enterprises, unmanaged P2P
activity creates risks:
❐

Excessive bandwidth consumptions affects mission-critical applications.

❐

Exponential security risk of exposure to viruses, spyware, and other malicious
content.

❐

The threat of legal action concerning the unlawful downloading of copyrighted music
and movies.

Managing P2P is a dynamic challenge, as the administrator must be able to evaluate both
P2P use and enterprise requirements.

About The Blue Coat Solution
The SG appliance recognizes P2P activity relating to P2P file sharing applications. By
constructing policy, you can control, block, and log P2P activity and limit the bandwidth
consumed by P2P traffic.
Note: Neither caching nor acceleration are provided with this feature.

Supported Services
This version of SGOS supports the following P2P services:
❐

FastTrack (Kazaa)

❐

EDonkey

❐

BitTorrent

❐

Gnutella

Note: Refer to the Release Notes for the most current list of P2P services and versions the
SG appliance supports.

Deployment
To effectively manage P2P activity, the SG appliance must be deployed to intercept
outbound network traffic and the firewall configured to block outbound connections that
are not initiated by the SG appliance.

188

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section E: Managing Peer-to-Peer Services
The default is detect_protocol(all).

Support CPL
The following properties can be used in conjunction with the P2P-specific CPL:
❐
❐

allow, deny, force_deny
access_server(yes | no)—If the value is determined as no, the client is

disconnected.
❐

authenticate(realm)—Unauthenticated clients are disconnected.

❐

socks_gateway(alias_list | no)

❐

socks_gateway.fail_open(yes | no)

❐

forward(alias_list) | no)—Only forwarding hosts currently supported by TCP

tunnels are supported.
❐

forward.fail_open(yes | no)

❐

reflect_ip(auto | no | client | vip | ip_address)

For complete CPL references, refer to Volume 10: Blue Coat SG Appliance Content Policy
Language Guide.

Policy Example
The following policy example demonstrates how to deny network traffic that the SG
appliance recognizes as P2P:
<proxy>
p2p.client=yes deny

P2P History Statistics
You can construct policy that controls, blocks, and logs peer-to-peer (P2P) activity and
limits the bandwidth consumed by P2P traffic (refer to Volume 6: VPM and Advanced Policy
for information about constructing P2P policy). The following section explains how to
view P2P statistics, using either the Management Console or the CLI.
Note: Some P2P statistics (P2P client connections and total bytes sent and received over a

period of time) can only be viewed through the Management Console (see "P2P Clients"
and "P2P Bytes", below).

P2P Data
The P2P Data tab on the Management Console displays P2P statistics, either all P2P
services at once or one service at a time.
The following table details the statistics provided through the Management Console P2P
Data tab or through the CLI
Table 4-2. P2P Data Statistics
Status

Description

Current Tunneled Sessions

The current number of P2P client connections using native
transport.

190

Chapter 4: Advanced Policy Tasks

Section E: Managing Peer-to-Peer Services

Proxy Authentication
While P2P protocols do not support native proxy authentication, most P2P clients support
SOCKS v5 and HTTP 1.1 proxies. P2P proxy authentication is supported only for clients
using these protocols (that are configured for proxy authentication).
For information about proxy authentication, refer to Volume 4: Securing the Blue Coat SG
Appliance. For a list of P2P clients suspected of not supporting SOCKS v5 with
authentication, see the Release Notes for this release.

Access Logging
P2P activity is logged and reviewable. Refer to Volume 8: Access Logging.

193

Volume 6: The Visual Policy Manager and Advanced Policy Tasks
Section F: Managing QoS and Differential Services

Section F: Managing QoS and Differential Services
This section describes how to create policy to manipulate Quality of Service (QoS)
information.

About The Blue Coat Solution
Beginning with SGOS 5.1.3, the SG appliance supports QoS detection, which is becoming
a more prevalent control point for network layer traffic. Previously, the QoS information
was lost—or not detected—when the SG appliance terminated the client connection and
issued a new connection to server. QoS support allows you to create policy to examine the
Type of Service (ToS) fields in the IP header to determine the QoS of the bits. The policy
then either tests and matches ToS information and performs an action, or performs an
action to manipulate ToS information based on something else in the rule (such as a user
group).
You can apply QoS policy to any protocol supported on the SG appliance.

About DSCP Values
Policy matches are based on Differentiated Services Code Point (DSCP) values, which
network devices use to identify traffic to be handled with higher or lower priority.
Identifying and matching values might trigger defined policy actions that either set a
different DSCP value or preserve or echo existing DSCP values to use for outbound
connections, thus regulating the QoS for different user classes (see descriptions in
subsequent sections).
Note: The SG appliance policy requests a QoS level. Whether or not a level of QoS
can be achieved depends upon your network/router configurations, which must also
allow the level of requested QoS.

ToS is an eight-bit field in the IP header; the first six bits are used and the final two are
reserved for other TCP specification and control. The first six bits constitute the DSCP
value. For most networks, the DSCP values adhere to a standard set. The following table
lists these values.
Table 4-3. DSCP Values and Descriptions
Name

DCSP Value

Description

Default

000000 (0)

Best effort (Precedence 0)

CS1

001000 (8)

Precedence 1

AF11

001010 (10)

Assured Forwarding Class 1, Low Drop Rate

AF12

001100 (12)

Assured Forwarding Class 1, Medium Drop Rate

AF13

001110 (14)

Assured Forwarding Class 1, High Drop Rate

CS2

010000 (16)

Precedence 2

AF21

010010 (18)

Assured Forwarding Class 2, Low Drop Rate

AF22

010100 (20)

Assured Forwarding Class 2, Low Drop Rate

194

Chapter 4: Advanced Policy Tasks

Section F: Managing QoS and Differential Services
Table 4-3. DSCP Values and Descriptions (Continued)
AF23

010110 (22)

Assured Forwarding Class 2, Low Drop Rate

CS3

011000 (24)

Precedence 3

AF31

011010 (26)

Assured Forwarding Class 3, Low Drop Rate

AF32

011100 (28)

Assured Forwarding Class 3, Medium Drop Rate

AF33

011110 (30)

Assured Forwarding Class 3, High Drop Rate

CS4

100000 (32)

Precedence 4

AF41

100010 (34)

Assured Forwarding Class 4, Low Drop Rate

AF42

100100 (36)

Assured Forwarding Class 4, Medium Drop Rate

AF43

100110 (38)

Assured Forwarding Class 4, High Drop Rate

CS5

101000 (40)

Precedence 5

EF

101110 (46)

Expedited Forwarding—low drop rate, low latency

CS6

110000 (48)

Precedence 6

CS7

111000 (56)

Precedence 7

Note:

Before creating policy, verify that your network adheres to these values. Other
DSCP values are possible. You can specify a numerical range from 0 to 63. However,
Blue Coat recommends using the above classifications, as most applications are
associated to these classes already, which makes defining policy an easier task.
The conceptual definitions of the different classes are:
❐

Best Effort—This is the default DSCP value if an application does not specify any
quality of service. The network delivers these packets if it can, but with no special
assigned priority. You can use other DSCP values to specify priorities that are either
above or below the Best Effort class; however, in most cases DSCP is used to specify
priorities that are better than Best Effort.

❐

Class Selector—These values are defined in RFC 2474 and are designed to be
backward compatible with the older Precedence field defined in RFC 791. Larger
precedence values indicate packets that are more important than packets with smaller
values of precedence; therefore, low-valued packets are dropped when a link becomes
congested. Most common, Precedence 7 is reserved for link-layer and routing protocol
keep-alive messages, and precedence 6 is reserved for other IP routing packets, both
of which must get through for the network to function correctly.

❐

Assured Forwarding—This is defined in RFC 2597. Assured Forwarding (AF) allows
you to specify both the relative priority and the drop sensitivity of traffic with a
Precendence class. For example, AF31 specifies low drop-rate with in the CS3
Precedence class.

❐

Expedited Forwarding—This is defined in RFC 2598. Expedited Forwarding (EF) is
usually reserved for premium traffic, or traffic that requires a virtual leased line. This
traffic is higher priority than AF, but lower priority than precedence 6 and 7 routing
messages.

195

Chapter 4: Advanced Policy Tasks

Section F: Managing QoS and Differential Services
❐

server.connection.dscp(0..63 | af11 | af12 | af13 | af21 | af22 | af23
| af31 | af32 | af33 | af41 | af42 | af43 | best-effort | cs1 | cs2 |
cs3 | cs4 | cs5 | cs6 | cs7 | ef | echo | preserve)

Valid layers: <proxy>, <dns-proxy>, <cache>, <forward>

Access Logging
The following access log formats are associated with QoS activity:
❐

x-cs-connection-dscp: The incoming client DSCP value.

❐

x-rs-connection-dscp: The incoming server DSCP value.

❐

x-sc-connection-dscp-decision: The client.connection.dscp () property

value, or preserve or echo.
❐

x-sr-connection-dscp-decision: The server.connection.dscp () property

value, or preserve or echo.

201

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

202

Appendix A: Glossary

A
access control list

Allows or denies specific IP addresses access to a server.

access log

A list of all the requests sent to an appliance. You can read an access log using any of
the popular log-reporting programs. When a client uses HTTP streaming, the
streaming entry goes to the same access log.

account

A named entity that has purchased the appliance or the Entitlements from Blue Coat.

activation code

A string of approximately 10 characters that is generated and mailed to customers
when they purchase the appliance.

active content stripping

Provides a way to identify potentially dangerous mobile or active content and
scripts, and strip them out of a response.

active content types

Used in the Visual Policy Manager. Referring to Web Access policies, you can create
and name lists of active content types to be stripped from Web pages. You have the
additional option of specifying a customized message to be displayed to the user

administration access policy

A policy layer that determines who can access the SG appliance to perform
administrative tasks.

administration
authentication policy

A policy layer that determines how administrators accessing the SG appliance must
authenticate.

Application Delivery
Network (ADN)

A WAN that has been optimized for acceleration and compression by Blue Coat. This
network can also be secured through the use of appliance certificates. An ADN
network is composed of an ADN manager and backup ADN manager, ADN nodes,
and a network configuration that matches the environment.

ADN backup manager

Takes over for the ADN manager in the event it becomes unavailable. See ADN
manager.

ADN manager

Responsible for publishing the routing table to SG Clients (and to other SG
appliances).

ADN optimize attribute

Controls whether to optimize bandwidth usage when connecting upstream using an
ADN tunnel.

asx rewrite

Allows you to rewrite URLs and then direct a client's subsequent request to the new
URL. One of the main applications of ASX file rewrites is to provide explicit proxylike support for Windows Media Player 6.4, which cannot set explicit proxy mode for
protocols other than HTTP.

audit

A log that provides a record of who accessed what and how.

203

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

authenticate-401 attribute

All transparent and explicit requests received on the port always use transparent
authentication (cookie or IP, depending on the configuration). This is especially
useful to force transparent proxy authentication in some proxy-chaining scenarios

authenticated content

Cached content that requires authentication at the origin content server (OCS).
Supported authentication types for cached data include basic authentication and
IWA (or NTLM).

authentication

Allows you to verify the identity of a user. In its simplest form, this is done through
usernames and passwords. Much more stringent authentication can be employed
using digital certificates that have been issued and verified by a Certificate Authority.
See also basic authentication, proxy authentication, and SSL authentication.

authentication realm

Authenticates and authorizes users to access SG services using either explicit proxy
or transparent proxy mode. These realms integrate third-party vendors, such as
LDAP, Windows, and Novell, with the Blue Coat operating system.

authorization

The permissions given to an authenticated user.

B
bandwidth class

A defined unit of bandwidth allocation.

bandwidth class hierarchy

Bandwidth classes can be grouped together in a class hierarchy, which is a tree
structure that specifies the relationship among different classes. You create a
hierarchy by creating at least one parent class and assigning other classes to be its
children.

bandwidth management

Classify, control, and, if needed, limit the amount of bandwidth used by network
traffic flowing in or out of an SG appliance.

basic authentication

The standard authentication for communicating with the target as identified in the
URL.

BCAAA

Blue Coat Authentication and Authorization Agent. Allows SGOS 5.x to manage
authentication and authorization for IWA, CA eTrust SiteMinder realms, Oracle
COREid, Novell, and Windows realms. The agent is installed and configured
separately from SGOS 5.x and is available from the Blue Coat Web site.

BCLP

Blue Coat Licensing Portal.

byte-range support

The ability of the SG appliance to respond to byte-range requests (requests with a
Range: HTTP header).

C
cache

An "object store," either hardware or software, that stores information (objects) for
later retrieval. The first time the object is requested, it is stored, making subsequent
requests for the same information much faster.
A cache helps reduce the response time and network bandwidth consumption on
future, equivalent requests. The SG appliance serves as a cache by storing content
from many users to minimize response time and prevent extraneous network traffic.

cache control

Allows you to configure which content the SG appliance stores.

204

Appendix A: Glossary

cache efficiency

A tab found on the Statistics pages of the Management Console that shows the
percent of objects served from cache, the percent loaded from the network, and the
percent that were non-cacheable.

cache hit

Occurs when the SG appliance receives a request for an object and can serve the
request from the cache without a trip to the origin server.

cache miss

Occurs when the appliance receives a request for an object that is not in the cache.
The appliance must then fetch the requested object from the origin server. .

cache object

Cache contents includes all objects currently stored by the SG appliance. Cache
objects are not cleared when the SG appliance is powered off.

Certificate Authority (CA)

A trusted, third-party organization or company that issues digital certificates used to
create digital signatures and public key/private key pairs. The role of the CA is to
guarantee that the individuals or company representatives who are granted a unique
certificate are who they claim to be.

child class (bandwidth gain)

The child of a parent class is dependent upon that parent class for available
bandwidth (they share the bandwidth in proportion to their minimum/maximum
bandwidth values and priority levels). A child class with siblings (classes with the
same parent class) shares bandwidth with those siblings in the same manner.

client consent certificates

A certificate that indicates acceptance or denial of consent to decrypt an end user's
HTTPS request.

client-side transparency

A way of replacing the appliance IP address with the Web server IP address for all
port 80 traffic destined to go to the client. This effectively conceals the SG appliance
address from the client and conceals the identity of the client from the Web server.

concentrator

An SG appliance, usually located in a data center, that provides access to data center
resources, such as file servers.

content filtering

A way of controlling which content is delivered to certain users. SG appliances can
filter content based on content categories (such as gambling, games, and so on), type
(such as http, ftp, streaming, and mime type), identity (user, group, network), or
network conditions. You can filter content using vendor-based filtering or by
allowing or denying access to URLs.

D
default boot system

The system that was successfully started last time. If a system fails to boot, the next
most recent system that booted successfully becomes the default boot system.

default proxy listener

See proxy service (d efault).

denial of service (DoS)

A method that hackers use to prevent or deny legitimate users access to a computer,
such as a Web server. DoS attacks typically send many request packets to a targeted
Internet server, flooding the server's resources and making the system unusable. Any
system connected to the Internet and equipped with TCP-based network services is
vulnerable to a DoS attack.
The SG appliance resists DoS attacks launched by many common DoS tools. With a
hardened TCP/IP stack, SG appliance resists common network attacks, including
traffic flooding.

205

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

destination objects

Used in Visual Policy Manager. These are the objects that define the target location of
an entry type.

detect protocol attribute

Detects the protocol being used. Protocols that can be detected include: HTTP, P2P
(eDonkey, BitTorrent, FastTrack, Gnutella), SSL, and Endpoint Mapper.

diagnostic reporting

Found in the Statistics pane, the Diagnostics tab allows you to control whether Daily
Heartbeats and/or Blue Coat Monitoring are enabled or disabled.

directives

Commands used in installable lists to configure forwarding and SOCKS gateway.

DNS access

A policy layer that determines how the SG appliance processes DNS requests.

domain name system (DNS)

An Internet service that translates domain names into IP addresses. See also private
DNS or public DNS.

dynamic bypass

Provides a maintenance-free method for improving performance of the SG appliance
by automatically compiling a list of requested URLs that return various kinds of
errors.

dynamic real-time rating
(DRTR)

Used in conjunction with the Blue Coat Web Filter (BCWF), DRTR (also known as
dynamic categorization) provides real-time analysis and content categorization of
requested Web pages to solve the problem of new and previously unknown
uncategorized URLs—those not in the database. When a user requests a URL that has
not already been categorized by the BCWF database (for example, a brand new Web
site), the SG appliance dynamic categorization service analyzes elements of the
requested content and assigns a category or categories. The dynamic service is
consulted only when the installed BCWF database does not contain category
information for an object.

E
early intercept attribute

Controls whether the proxy responds to client TCP connection requests before
connecting to the upstream server. When early intercept is disabled, the proxy delays
responding to the client until after it has attempted to contact the server.

ELFF-compatible format

A log type defined by the W3C that is general enough to be used with any protocol.

emulated certificates

Certificates that are presented to the user by SG appliance when intercepting HTTPS
requests. Blue Coat emulates the certificate from the server and signs it, copying the
subjectName and expiration. The original certificate is used between the SG
appliance and the server.

encrypted log

A log is encrypted using an external certificate associated with a private key.
Encrypted logs can only be decrypted by someone with access to the private key. The
private key is not accessible to the SG appliance.

EULA

End user license agreement.

event logging

Allows you to specify the types of system events logged, the size of the event log, and
to configure Syslog monitoring. The appliance can also notify you by email if an
event is logged. See also access logging.

206

Appendix A: Glossary

explicit proxy

A configuration in which the browser is explicitly configured to communicate with
the proxy server for access to content.
This is the default for the SG appliance, and requires configuration for both browser
and the interface card.

extended log file format
(ELFF)

A variant of the common log file format, which has two additional fields at the end of
the line—the referer and the user agent fields.

F
fail open/closed

Failing open or closed applies to forwarding hosts and groups and SOCKS gateways.
Fail open or closed applies when health checks are showing sick for each forwarding
or SOCKS gateway target in the applicable fail-over sequence. If no systems are
healthy, the SG appliance fails open or closed, depending on the configuration. If
closed, the connection attempt simply fails.
If open, an attempt is made to connect without using any forwarding target (or
SOCKS gateway). Fail open is usually a security risk; fail closed is the default if no
setting is specified.

filtering

See content filtering.

forward proxy

A proxy server deployed close to the clients and used to access many servers. A
forward proxy can be explicit or transparent.

FTP

See Native FTP; Web FTP.

G
gateway

A device that serves as entrance and exit into a communications network.

H
hardware serial number

A string that uniquely identifies the appliance; it is assigned to each unit in
manufacturing.

health check tests

The method of determining network connectivity, target responsiveness, and basic
functionality. The following tests are supported:
• ICMP
• TCP
• SSL
• HTTP
• HTTPS
• Group
• Composite and reference to a composite result
• ICAP
• Websense
• DRTR rating service

207

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

health check type

The kind of device or service the specific health check tests. The following types are
supported:
• Forwarding host and forwarding group
• SOCKS gateway and SOCKS gateway group
• CAP service and ICAP service group
• Websense off-box service and Websense off-box service group
• DRTR rating service
• User-defined host and a user-defined composite

heartbeat

Messages sent once every 24 hours that contain the statistical and configuration data
for the SG appliance, indicating its health. Heartbeats are commonly sent to system
administrators and to Blue Coat. Heartbeats contain no private information, only
aggregate statistics useful for pre-emptively diagnosing support issues.
The SG appliance sends emergency heartbeats whenever it is rebooted. Emergency
heartbeats contain core dump and restart flags in addition to daily heartbeat
information.

host affinity

The attempt to direct multiple connections by a single user to the same group
member. Host affinity is closely tied to load balancing behavior; both should be
configured if load balancing is important.

host affinity timeout

The host affinity timeout determines how long a user remains idle before the
connection is closed. The timeout value checks the user's IP address, SSL ID, or
cookie in the host affinity table.

I
inbound traffic (bandwidth
gain)

Network packets flowing into the SG appliance. Inbound traffic mainly consists of
the following:
• Server inbound: Packets originating at the origin content server (OCS) and sent to
the SG appliance to load a Web object.
• Client inbound: Packets originating at the client and sent to the SG appliance for
Web requests.

installable lists

Installable lists, comprised of directives, can be placed onto the SG appliance in one
of the following ways:
• Creating the list using the SG text editor
• Placing the list at an accessible URL
• Downloading the directives file from the local system

integrated host timeout

An integrated host is an origin content server (OCS) that has been added to the health
check list. The host, added through the integrate_new_hosts property, ages out
of the integrated host table after being idle for the specified time. The default is 60
minutes.

intervals

Time period from the completion of one health check to the start of the next health
check.

IP reflection

Determines how the client IP address is presented to the origin server for explicitly
proxied requests. All proxy services contain a reflect-ip attribute, which enables or
disables sending of client's IP address instead of the SG's IP address.

208

Appendix A: Glossary

issuer keyring

The keyring used by the SG appliance to sign emulated certificates. The keyring is
configured on the appliance and managed through policy.

L
licensable component (LC)

(Software) A subcomponent of a license; it is an option that enables or disables a
specific feature.

license

Provides both the right and the ability to use certain software functions within an AV
(or SG) appliance. The license key defines and controls the license, which is owned
by an account.

listener

The service that is listening on a specific port. A listener can be identified by any
destination IP/subnet and port range. Multiple listeners can be added to each
service.

live content

Also called live broadcast. Used in streaming, it indicates that the content is being
delivered fresh.

LKF

License key file.

load balancing

A way to share traffic requests among multiple upstream systems or multiple IP
addresses on a single host.

local bypass list

A list you create and maintain on your network. You can use a local bypass list alone
or in conjunction with a central bypass list. See bypass list.

local policy file

Written by enterprises (as opposed to the central policy file written by Blue Coat);
used to create company- and department-specific advanced policies written in the
Blue Coat Policy Language (CPL).

log facility

A separate log that contains a single logical file and supports a single log format. It
also contains the file’s configuration and upload schedule information as well as
other configurable information such as how often to rotate (switch to a new log) the
logs at the destination, any passwords needed, and the point at which the facility can
be uploaded.

log format

The type of log that is used: NCSA/Common, SQUID, ELFF, SurfControl, or
Websense.
The proprietary log types each have a corresponding pre-defined log format that has
been set up to produce exactly that type of log (these logs cannot be edited). In
addition, a number of other ELFF type log formats are also pre-defined (im, main,
p2p, ssl, streaming). These can be edited, but they start out with a useful set of log
fields for logging particular protocols understood by the SG appliance. It is also
possible to create new log formats of type ELFF or Custom which can contain any
desired combination of log fields.

log tail

The access log tail shows the log entries as they get logged. With high traffic on the
SG appliance, not all access log entries are necessarily displayed. However, you can
view all access log information after uploading the log.

M
MACH5

SGOS 5 MACH5 Edition.

209

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

Management Console

A graphical Web interface that lets you to manage, configure, monitor, and upgrade
the SG appliance from any location. The Management Console consists of a set of
Web pages and Java applets stored on the SG appliance. The appliance acts as a Web
server on the management port to serve these pages and applets.

management information
base (MIB)

Defines the statistics that management systems can collect. A managed device
(gateway) has one or more MIBs as well as one or more SNMP agents, which
implements the information and management functionality defined by a specific
MIB.

maximum object size

The maximum object size stored in the SG appliance. All objects retrieved that are
greater than the maximum size are delivered to the client but are not stored in the SG
appliance.

MIME/FILE type filtering

Allows organizations to implement Internet policies for both uploaded and
downloaded content by MIME or FILE type.

multi-bit rate

The capability of a single stream to deliver multiple bit rates to clients requesting
content from appliances from within varying levels of network conditions (such as
different connecting bandwidths and traffic).

multicast

Used in streaming; the ability for hundreds or thousands of users to play a single
stream.

multicast aliases

Used in streaming; a streaming command that specifies an alias for a multicast URL
to receive an .nsc file. The .nsc files allows the multicast session to obtain the
information in the control channel

multicast station

Used in streaming; a defined location on the proxy where the Windows Media player
can retrieve streams. A multicast station enables multicast transmission of Windows
Media content from the cache. The source of the multicast-delivered content can be a
unicast-live source, a multicast (live) source, and simulated live (video-on-demand
content converted to scheduled live content).

multimedia content services

Used in streaming; multimedia support includes Real Networks, Microsoft Windows
Media, Apple QuickTime, MP3, and Flash.

N
name inputing

Allows an SG appliance to resolve host names based on a partial name specification.
When a host name is submitted to the DNS server, the DNS server resolves the name
to an IP address. If the host name cannot be resolved, Blue Coat adds the first entry in
the name-inputing list to the end of the host name and resubmits it to the DNS server

native FTP

Native FTP involves the client connecting (either explicitly or transparently) using
the FTP protocol; the SG appliance then connects upstream through FTP (if
necessary).

NCSA common log format

Blue Coat products are compatible with this log type, which contains only basic
HTTP access information.

network address translation
(NAT)

The process of translating private network (such as intranet) IP addresses to Internet
IP addresses and vice versa. This methodology makes it possible to match private IP
addresses to Internet IP addresses even when the number of private addresses
outnumbers the pool of available Internet addresses.

210

Appendix A: Glossary

non-cacheable objects

A number of objects are not cached by the Blue Coat appliance because they are
considered non-cacheable. You can add or delete the kinds of objects that the
appliance considers non-cacheable. Some of the non-cacheable request types are:
• Pragma no-cache, requests that specify non-cached objects, such as when you click
refresh in the Web browser.
• Password provided, requests that include a client password.
• Data in request that include additional client data.
• Not a GET request.

.nsc file

Created from the multicast station definition and saved through the browser as a text
file encoded in a Microsoft proprietary format. Without an .nsc file, the multicast
station definition does not work.

NTP

To manage objects in an appliance, an SG appliance must know the current Universal
Time Coordinates (UTC) time. By default, the SG appliance attempts to connect to a
Network Time Protocol (NTP) server to acquire the UTC time. SG appliance includes
a list of NTP servers available on the Internet, and attempts to connect to them in the
order they appear in the NTP server list on the NTP tab.

O
object (used in caching)

An object is the item that is stored in an appliance. These objects can be frequently
accessed content, content that has been placed there by content publishers, or Web
pages, among other things.

object (used in Visual Policy
Manager)

An object (sometimes referred to as a condition) is any collection or combination of
entry types you can create individually (user, group, IP address/subnet, and
attribute). To be included in an object, an item must already be created as an
individual entry.

object pipelining

This patented algorithm opens as many simultaneous TCP connections as the origin
server will allow and retrieves objects in parallel. The objects are then delivered from
the appliance straight to the user's desktop as fast as the browser can request them.

origin content server (OCS)

Also called origin server. This is the original source of the content that is being
requested. An appliance needs the OCS to acquire data the first time, to check that
the content being served is still fresh, and to authenticate users.

outbound traffic (bandwidth
gain)

Network packets flowing out of the SG appliance. Outbound traffic mainly consists
of the following:
• Client outbound: Packets sent to the client in response to a Web request.
• Server outbound: Packets sent to an OCS or upstream proxy to request a service.

P
PAC (Proxy
AutoConfiguration) scripts

Originally created by Netscape, PACs are a way to avoid requiring proxy hosts and
port numbers to be entered for every protocol. You need only enter the URL. A PAC
can be created with the needed information and the local browser can be directed to
the PAC for information about proxy hosts and port numbers.

packet capture (PCAP)

Allows filtering on various attributes of the Ethernet frame to limit the amount of
data collected. You can capture packets of Ethernet frames going into or leaving an
SG appliance.

211

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

parent class (bandwidth
gain)

A class with at least one child. The parent class must share its bandwidth with its
child classes in proportion to the minimum/maximum bandwidth values or priority
levels.

passive mode data
connections (PASV)

Data connections initiated by an FTP client to an FTP server.

pipelining

See object pipelining.

policies

Groups of rules that let you manage Web access specific to the needs of an enterprise.
Policies enhance SG appliance feature areas such as authentication and virus
scanning, and let you control end-user Web access in your existing infrastructure.
See also refresh policies.

policy-based bypass list

Used in policy. Allows a bypass based on the properties of the client, unlike static and
dynamic bypass lists, which allow traffic to bypass the appliance based on
destination IP address. See also bypass lists and dynamic bypass.

policy layer

A collection of rules created using Blue Coat CPL or with the VPM.

pragma: no cache (PNC)

A metatag in the header of a request that requires the appliance to forward a request
to the origin server. This allows clients to always obtain a fresh copy (of the request?).

proxy

Caches content, filters traffic, monitors Internet and intranet resource usage, blocks
specific Internet and intranet resources for individuals or groups, and enhances the
quality of Internet or intranet user experiences.
A proxy can also serve as an intermediary between a Web client and a Web server
and can require authentication to allow identity based policy and logging for the
client.
The rules used to authenticate a client are based on the policies you create on the SG
appliance, which can reference an existing security infrastructure—LDAP, RADIUS,
IWA, and the like.

Proxy Edition

SGOS 5 Proxy Edition.

proxy service

The proxy service defines the ports, as well as other attributes. that are used by the
proxies associated with the service.

proxy service (default)

The default proxy service is a service that intercepts all traffic not otherwise
intercepted by other listeners. It only has one listener whose action can be set to
bypass or intercept. No new listeners can be added to the default proxy service, and
the default listener and service cannot be deleted. Service attributes can be changed.

public key certificate

An electronic document that encapsulates the public key of the certificate sender,
identifies this sender, and aids the certificate receiver to verify the identity of the
certificate sender. A certificate is often considered valid if it has been digitally signed
by a well-known entity, which is called a Certificate Authority (such as VeriSign).

public virtual IP (VIP)

Maps multiple servers to one IP address and then propagates that information to the
public DNS servers. Typically, there is a public VIP known to the public Internet that
routes the packets internally to the private VIP. This enables you to “hide” your
servers from the Internet.

212

Appendix A: Glossary

R
real-time streaming protocol
(RTSP)

A standard method of transferring audio and video and other time-based media over
Internet-technology based networks. The protocol is used to stream clips to any RTPbased client.

reflect client IP attribute

Enables the sending of the client's IP address instead of the SG's IP address to the
upstream server. If you are using an application delivery network (ADN), this setting
is enforced on the concentrator proxy through the Configuration > App. Delivery
Network > Tunneling tab.

registration

An event that binds the appliance to an account, that is, it creates the Serial#, Account
association.

remote authentication dialin user service (RADIUS)

Authenticates user identity via passwords for network access.

reverse proxy

A proxy that acts as a front-end to a small number of pre-defined servers, typically to
improve performance. Many clients can use it to access the small number of
predefined servers.

routing information protocol
(RIP)

Designed to select the fastest route to a destination. RIP support is built into Blue
Coat appliances.

router hops

The number of jumps a packet takes when traversing the Internet.

S
secure shell (SSH)

Also known as Secure Socket Shell. SSH is an interface and protocol that provides
strong authentication and enables you to securely access a remote computer. Three
utilities—login, ssh, and scp—comprise SSH. Security via SSH is accomplished using
a digital certificate and password encryption. Remember that the Blue Coat SG
appliance requires SSH1. An SG appliance supports a combined maximum of 16
Telnet and SSH sessions.

serial console

A third-party device that can be connected to one or more Blue Coat appliances.
Once connected, you can access and configure the appliance through the serial
console, even when you cannot access the appliance directly.

server certificate categories

The hostname in a server certificate can be categorized by BCWF or another content
filtering vendor to fit into categories such as banking, finance, sports.

server portals

Doorways that provide controlled access to a Web server or a collection of Web
servers. You can configure Blue Coat SG appliances to be server portals by mapping a
set of external URLs onto a set of internal URLs.

server-side transparency

The ability for the server to see client IP addresses, which enables accurate clientaccess records to be kept. When server-side transparency is enabled, the appliance
retains client IP addresses for all port 80 traffic to and from the SG appliance. In this
scheme, the client IP address is always revealed to the server.

service attributes

Define the parameters, such as explicit or transparent, cipher suite, and certificate
verification, that the SG appliance uses for a particular service. .

213

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

SG appliance

A Blue Coat security and cache box that can help manage security and content on a
network.

sibling class (bandwidth
gain)

A bandwidth class with the same parent class as another class.

simple network
management protocol
(SNMP)

The standard operations and maintenance protocol for the Internet. It uses MIBs,
created or customized by Blue Coat, to handle (needs completion).

simulated live

Used in streaming. Defines playback of one or more video-on-demand files as a
scheduled live event, which begins at a specified time. The content can be looped
multiple times, or scheduled to start at multiple start times throughout the day.

SmartReporter log type

A proprietary ELFF log type that is compatible with the SmartFilter SmartReporter
tool.

SOCKS

A proxy protocol for TCP/IP-based networking applications that allows users
transparent access across the firewall. If you are using a SOCKS server for the
primary or alternate forwarding gateway, you must specify the appliance’s ID for the
identification protocol used by the SOCKS gateway. The machine ID should be
configured to be the same as the appliance’s name.

SOCKS proxy

A generic way to proxy TCP and UDP protocols. The SG appliance supports both
SOCKSv4/4a and SOCKSv5; however, because of increased username and password
authentication capabilities and compression support, Blue Coat recommends that
you use SOCKS v5.

splash page

Custom message page that displays the first time you start the client browser.

split proxy

Employs co-operative processing at the branch and the core to implement
functionality that is not possible in a standalone proxy. Examples of split proxies
include:
• Mapi Proxy
• SSL Proxy

SQUID-compatible format

A log type that was designed for cache statistics and is compatible with Blue Coat
products.

squid-native log format

The Squid-compatible format contains one line for each request.

SSL authentication

Ensures that communication is with “trusted” sites only. Requires a certificate issued
by a trusted third party (Certificate Authority).

SSL interception

Decrypting SSL connections.

SSL proxy

A proxy that can be used for any SSL traffic (HTTPS or not), in either forward or
reverse proxy mode.

static route

A manually-configured route that specifies the transmission path a packet must
follow, based on the packet’s destination address. A static route specifies a
transmission path to another network.

214

Appendix A: Glossary

statistics

Every Blue Coat appliance keeps statistics of the appliance hardware and the objects
it stores. You can review the general summary, the volume, resources allocated, cache
efficiency, cached contents, and custom URLs generated by the appliance for various
kinds of logs. You can also check the event viewer for every event that occurred since
the appliance booted.

stream

A flow of a single type of data, measured in kilobits per second (Kbps). A stream
could be the sound track to a music video, for example.

SurfControl log type

A proprietary log type that is compatible with the SurfControl reporter tool. The
SurfControl log format includes fully-qualified usernames when an NTLM realm
provides authentication. The simple name is used for all other realm types.

syslog

An event-monitoring scheme that is especially popular in Unix environments. Most
clients using Syslog have multiple devices sending messages to a single Syslog
daemon. This allows viewing a single chronological event log of all of the devices
assigned to the Syslog daemon. The Syslog format is: “Date Time Hostname Event.”

system cache

The software cache on the appliance. When you clear the cache, all objects in the
cache are set to expired. The objects are not immediately removed from memory or
disk, but a subsequent request for any object requested is retrieved from the origin
content server before it is served.

T
time-to-live (TTL) value

Used in any situation where an expiration time is needed. For example, you do not
want authentication to last beyond the current session and also want a failed
command to time out instead of hanging the box forever.

traffic flow
(bandwidth gain)

Also referred to as flow. A set of packets belonging to the same TCP/UDP connection
that terminate at, originate at, or flow through the SG appliance. A single request
from a client involves two separate connections. One of them is from the client to the
SG appliance, and the other is from the SG appliance to the OCS. Within each of
these connections, traffic flows in two directions—in one direction, packets flow out
of the SG appliance (outbound traffic), and in the other direction, packets flow into
the SG (inbound traffic). Connections can come from the client or the server. Thus,
traffic can be classified into one of four types:
• Server inbound
• Server outbound
• Client inbound
• Client outbound
These four traffic flows represent each of the four combinations described above.
Each flow represents a single direction from a single connection.

transmission control
protocol (TCP)

TCP, when used in conjunction with IP (Internet Protocol) enables users to send data,
in the form of message units called packets, between computers over the Internet.
TCP is responsible for tracking and handling, and reassembly of the packets; IP is
responsible for packet delivery.

transparent proxy

A configuration in which traffic is redirected to the SG appliance without the
knowledge of the client browser. No configuration is required on the browser, but
network configuration, such as an L4 switch or a WCCP-compliant router, is
required.

215

Volume 6: The Visual Policy Manager and Advanced Policy Tasks

trial period

Starting with the first boot, the trial period provides 60 days of free operation. All
features are enabled during this time.

U
unicast alias

Defines an name on the appliance for a streaming URL. When a client requests the
alias content on the appliance, the appliance uses the URL specified in the unicastalias command to request the content from the origin streaming server.

universal time coordinates
(UTC)

An SG appliance must know the current UTC time. By default, the appliance
attempts to connect to a Network Time Protocol (NTP) server to acquire the UTC
time. If the SG appliance cannot access any NTP servers, you must manually set the
UTC time.

URL filtering

See content filtering.

URL rewrite rules

Rewrite the URLs of client requests to acquire the streaming content using the new
URL. For example, when a client tries to access content on www.mycompany.com,
the appliance is actually receiving the content from the server on 10.253.123.123. The
client is unaware that mycompany.com is not serving the content; however, the
appliance access logs indicate the actual server that provides the content.

W
WCCP

Web Cache Communication Protocol. Allows you to establish redirection of the
traffic that flows through routers.

Web FTP

Web FTP is used when a client connects in explicit mode using HTTP and accesses an
ftp:// URL. The SG appliance translates the HTTP request into an FTP request for the
OCS (if the content is not already cached), and then translates the FTP response with
the file contents into an HTTP response for the client.

Websense log type

A Blue Coat proprietary log type that is compatible with the Websense reporter tool.

X

XML responder

HTTP XML service that runs on an external server.

XML requestor

XML realm.

216

